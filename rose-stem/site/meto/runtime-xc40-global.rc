{% if "meto_xc40_mogreps_g_eg" in name_graphs_out -%}
# XC40 MOGREPS-G-EG 
    [[METO_XC40_MOGREPS_G_EG]]
        script = "{{TASK_RUN}} --verbose {{UM_XC40_CCE_SAFE_OMP_SINGLE_PRECIS}}"
        [[[environment]]]
            KGO_XC40_MOGREPS_G_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_mogreps_g_eg/{{XC40_MOGREPS_G_EG_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_mogreps_g_eg]]
        script = "{{TASK_RUN_RECON}} --verbose {{UM_XC40_CCE_SAFE_OMP_SINGLE_PRECIS}}"
        inherit = METO_XC40_MOGREPS_G_EG, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_MOGREPS_G_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_eg/atmos.astart
        [[[directives]]]
            -l mem = 14GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run
    [[atmos_meto_xc40_mogreps_g_eg_8x26]]
        inherit = METO_XC40_MOGREPS_G_EG, METO_XC40_IOS_ON, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x26, IOS_8, UM_MOGREPS_G_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_eg/atmos.astart
        [[[job]]]
            execution time limit = PT12M

    # Comparison tasks
    [[rose_ana_meto_xc40_mogreps_g_eg_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EG, METO_XC40, ROSE_ANA_MOGREPS_G_EG
        [[[environment]]]
            DIR0=$KGO_XC40_MOGREPS_G_EG_DIR
            DIR1=../atmos_meto_xc40_mogreps_g_eg_8x26
            KGO=0

    # Comparison tasks
    [[rose_ana_meto_xc40_mogreps_g_eg_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_MOGREPS_G_EG, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_mogreps_g_eg_8x26
            DIR1=$KGO_XC40_MOGREPS_G_EG_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1

    [[rose_ana_meto_xc40_mogreps_g_eg_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_MOGREPS_G_EG_DIR
            DIR1=../recon_meto_xc40_mogreps_g_eg
            KGO=0

{%- if INTEGRATION_TESTING == true %}
   # Reconfiguration 2x4 for proc comparison
   [[recon_meto_xc40_mogreps_g_eg_2x4]]
        script = "{{TASK_RUN_RECON}} --verbose {{UM_XC40_CCE_SAFE_OMP}}"
        inherit = METO_XC40_MOGREPS_G_EG, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_MOGREPS_G_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_eg_2x4/atmos.astart
        [[[directives]]]
            -l mem = 14GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_mogreps_g_eg_reprod_6x36]]
        inherit = METO_XC40_MOGREPS_G_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x36, IOS_0, UM_MOGREPS_G_EG
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_eg/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod
        [[[job]]]
            execution time limit = PT13M

    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_mogreps_g_eg_reprod_12x18]]
        inherit = METO_XC40_MOGREPS_G_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x18, IOS_0, UM_MOGREPS_G_EG
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_eg/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod
        [[[job]]]
            execution time limit = PT10M

    # Comparison task
    [[rose_ana_meto_xc40_mogreps_g_eg_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EG, METO_XC40, ROSE_ANA_MOGREPS_G_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_mogreps_g_eg_reprod_6x36
            DIR1=../atmos_meto_xc40_mogreps_g_eg_reprod_12x18
            KGO=

    [[rose_ana_meto_xc40_mogreps_g_eg_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_mogreps_g_eg
            DIR1=../recon_meto_xc40_mogreps_g_eg_2x4
            KGO=

{%- endif %}

{%- endif %}


{% if "meto_xc40_mogreps_g_exp_eg" in name_graphs_out -%}
# XC40 MOGREPS-G-EG 
    [[METO_XC40_MOGREPS_G_EXP_EG]]
        script = "{{TASK_RUN}} --verbose {{UM_XC40_CCE_SAFE_OMP_SINGLE_PRECIS}}"
        [[[environment]]]
            KGO_XC40_MOGREPS_G_EXP_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_mogreps_g_exp_eg/{{XC40_MOGREPS_G_EXP_EG_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_mogreps_g_exp_eg]]
        script = "{{TASK_RUN_RECON}} --verbose {{UM_XC40_CCE_SAFE_OMP_SINGLE_PRECIS}}"
        inherit = METO_XC40_MOGREPS_G_EXP_EG, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_MOGREPS_G_EXP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_exp_eg/atmos.astart
        [[[directives]]]
            -l mem = 14GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run
    [[atmos_meto_xc40_mogreps_g_exp_eg_8x26]]
        inherit = METO_XC40_MOGREPS_G_EXP_EG, METO_XC40_IOS_ON, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x26, IOS_8, UM_MOGREPS_G_EXP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_exp_eg/atmos.astart
        [[[job]]]
            execution time limit = PT12M

    # Comparison tasks
    [[rose_ana_meto_xc40_mogreps_g_exp_eg_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EXP_EG, METO_XC40, ROSE_ANA_MOGREPS_G_EXP_EG
        [[[environment]]]
            DIR0=$KGO_XC40_MOGREPS_G_EXP_EG_DIR
            DIR1=../atmos_meto_xc40_mogreps_g_exp_eg_8x26
            KGO=0

    # Comparison tasks
    [[rose_ana_meto_xc40_mogreps_g_exp_eg_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_MOGREPS_G_EXP_EG, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_mogreps_g_exp_eg_8x26
            DIR1=$KGO_XC40_MOGREPS_G_EXP_EG_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1

    [[rose_ana_meto_xc40_mogreps_g_exp_eg_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EXP_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_MOGREPS_G_EXP_EG_DIR
            DIR1=../recon_meto_xc40_mogreps_g_exp_eg
            KGO=0

{%- if INTEGRATION_TESTING == true %}
   # Reconfiguration 2x4 for proc comparison
   [[recon_meto_xc40_mogreps_g_exp_eg_2x4]]
        script = "{{TASK_RUN_RECON}} --verbose {{UM_XC40_CCE_SAFE_OMP}}"
        inherit = METO_XC40_MOGREPS_G_EXP_EG, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_MOGREPS_G_EXP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_exp_eg_2x4/atmos.astart
        [[[directives]]]
            -l mem = 14GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_mogreps_g_exp_eg_reprod_6x36]]
        inherit = METO_XC40_MOGREPS_G_EXP_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x36, IOS_0, UM_MOGREPS_G_EXP_EG
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_exp_eg/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod
        [[[job]]]
            execution time limit = PT13M

    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_mogreps_g_exp_eg_reprod_12x18]]
        inherit = METO_XC40_MOGREPS_G_EXP_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x18, IOS_0, UM_MOGREPS_G_EXP_EG
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_mogreps_g_exp_eg/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod
        [[[job]]]
            execution time limit = PT10M

    # Comparison task
    [[rose_ana_meto_xc40_mogreps_g_exp_eg_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EXP_EG, METO_XC40, ROSE_ANA_MOGREPS_G_EXP_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_mogreps_g_exp_eg_reprod_6x36
            DIR1=../atmos_meto_xc40_mogreps_g_exp_eg_reprod_12x18
            KGO=

    [[rose_ana_meto_xc40_mogreps_g_exp_eg_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_MOGREPS_G_EXP_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_mogreps_g_exp_eg
            DIR1=../recon_meto_xc40_mogreps_g_exp_eg_2x4
            KGO=

{%- endif %}

{%- endif %}



{% if "meto_xc40_n96_glomap_clim" in name_graphs_out -%}
    # XC40 GLOMAP CLIM N96
    [[METO_XC40_N96_GLOMAP_CLIM]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_GLOMAP_CLIM_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_glomap_clim/{{XC40_N96_GLOMAP_CLIM_KGO}}

    # Reconfiguration 2x4 
    [[recon_meto_xc40_n96_glomap_clim_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N96_GLOMAP_CLIM, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_N96_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_glomap_clim_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT3M

    # Reconfiguration 4x2 for proc comparison
    [[recon_meto_xc40_n96_glomap_clim_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N96_GLOMAP_CLIM, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_N96_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_glomap_clim_4x2/atmos.astart
        [[[job]]]
            execution time limit = PT3M

    # Atmosphere 16x9 Model Run 2days 
    [[atmos_meto_xc40_n96_glomap_clim_16x9]]
        inherit = METO_XC40_N96_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N96_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_glomap_clim_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere 12x12 Model Run for proc comparison
    [[atmos_meto_xc40_n96_glomap_clim_12x12]]
        inherit = METO_XC40_N96_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_12x12, IOS_0, UM_N96_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_glomap_clim_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run 1day NRUN
    [[atmos_meto_xc40_n96_glomap_clim_nrun_16x9]]
        inherit = METO_XC40_N96_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N96_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_glomap_clim_2x4/atmos.astart
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N96_GLOMAP_CLIM
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N96_GLOMAP_CLIM
            ROSE_APP_OPT_CONF_KEYS= nrun
        [[[job]]]
            execution time limit = PT4M

    # Atmosphere Model Run 1day CRUN
    [[atmos_meto_xc40_n96_glomap_clim_crun_16x9]]
        inherit = METO_XC40_N96_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N96_GLOMAP_CLIM
        [[[environment]]]
            ASTART=
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N96_GLOMAP_CLIM
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N96_GLOMAP_CLIM
        [[[job]]]
            execution time limit = PT16M

    # Comparison tasks
    [[rose_ana_meto_xc40_n96_glomap_clim_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_GLOMAP_CLIM, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N96_GLOMAP_CLIM_DIR
            DIR1=../recon_meto_xc40_n96_glomap_clim_2x4
            KGO=0

    [[rose_ana_meto_xc40_n96_glomap_clim_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_GLOMAP_CLIM, METO_XC40, ROSE_ANA_N96_GLOMAP_CLIM
        [[[environment]]]
            DIR0=$KGO_XC40_N96_GLOMAP_CLIM_DIR
            DIR1=../atmos_meto_xc40_n96_glomap_clim_16x9
            KGO=0

    [[rose_ana_meto_xc40_n96_glomap_clim_atmos_nruncrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_GLOMAP_CLIM, METO_XC40, ROSE_ANA_N96_GLOMAP_CLIM
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N96_GLOMAP_CLIM
            DIR1=../atmos_meto_xc40_n96_glomap_clim_16x9
            KGO=
            ROSE_APP_OPT_CONF_KEYS= nruncrun

    [[rose_ana_meto_xc40_n96_glomap_clim_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_GLOMAP_CLIM, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n96_glomap_clim_2x4
            DIR1=../recon_meto_xc40_n96_glomap_clim_4x2
            KGO=

    [[rose_ana_meto_xc40_n96_glomap_clim_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_GLOMAP_CLIM, METO_XC40, ROSE_ANA_N96_GLOMAP_CLIM
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_glomap_clim_16x9
            DIR1=../atmos_meto_xc40_n96_glomap_clim_12x12
            KGO=

{%- endif %}



{% if "meto_xc40_n48_glomap_clim" in name_graphs_out -%}
    # XC40 GLOMAP CLIM N48
    [[METO_XC40_N48_GLOMAP_CLIM]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GLOMAP_CLIM_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_glomap_clim/{{XC40_N48_GLOMAP_CLIM_KGO}}

    # Reconfiguration 2x4
    [[recon_meto_xc40_n48_glomap_clim_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GLOMAP_CLIM, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT3M

    # Reconfiguration 4x2 for proc comparison
    [[recon_meto_xc40_n48_glomap_clim_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GLOMAP_CLIM, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_4x2/atmos.astart
        [[[job]]]
            execution time limit = PT3M

    # Atmosphere Model Run 2days 
    [[atmos_meto_xc40_n48_glomap_clim_16x9]]
        inherit = METO_XC40_N48_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT8M

    # Atmosphere 12x12 Model Run for proc comparison
    [[atmos_meto_xc40_n48_glomap_clim_12x12]]
        inherit = METO_XC40_N48_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_12x12, IOS_0, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT8M

    # Atmosphere Model Run 1day NRUN
    [[atmos_meto_xc40_n48_glomap_clim_nrun_16x9]]
        inherit = METO_XC40_N48_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_2x4/atmos.astart
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GLOMAP_CLIM
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GLOMAP_CLIM
            ROSE_APP_OPT_CONF_KEYS= nrun
        [[[job]]]
            execution time limit = PT4M

    # Atmosphere Model Run 1day CRUN
    [[atmos_meto_xc40_n48_glomap_clim_crun_16x9]]
        inherit = METO_XC40_N48_GLOMAP_CLIM, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GLOMAP_CLIM
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GLOMAP_CLIM
        [[[job]]]
            execution time limit = PT8M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_glomap_clim_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GLOMAP_CLIM_DIR
            DIR1=../recon_meto_xc40_n48_glomap_clim_2x4
            KGO=0

    [[rose_ana_meto_xc40_n48_glomap_clim_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM, METO_XC40, ROSE_ANA_N48_GLOMAP_CLIM
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GLOMAP_CLIM_DIR
            DIR1=../atmos_meto_xc40_n48_glomap_clim_16x9
            KGO=0

    [[rose_ana_meto_xc40_n48_glomap_clim_atmos_nruncrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM, METO_XC40, ROSE_ANA_N48_GLOMAP_CLIM
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GLOMAP_CLIM
            DIR1=../atmos_meto_xc40_n48_glomap_clim_16x9
            KGO=
            ROSE_APP_OPT_CONF_KEYS= nruncrun

    [[rose_ana_meto_xc40_n48_glomap_clim_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_glomap_clim_2x4
            DIR1=../recon_meto_xc40_n48_glomap_clim_4x2
            KGO=

    [[rose_ana_meto_xc40_n48_glomap_clim_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM, METO_XC40, ROSE_ANA_N48_GLOMAP_CLIM
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_glomap_clim_16x9
            DIR1=../atmos_meto_xc40_n48_glomap_clim_12x12
            KGO=

{%- endif %}



{% if "meto_xc40_n48_glomap_clim_comp_check" in name_graphs_out -%}
    # XC40 GLOMAP CLIM N48
    [[METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GLOMAP_CLIM_COMP_CHECK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_glomap_clim_comp_check/{{XC40_N48_GLOMAP_CLIM_COMP_CHECK_KGO}}

    # Reconfiguration 2x4
    [[recon_meto_xc40_n48_glomap_clim_comp_check_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_comp_check_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    # Reconfiguration 4x2 for proc comparison
    [[recon_meto_xc40_n48_glomap_clim_comp_check_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_comp_check_4x2/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    # Atmosphere 16x9 two day model Run
    [[atmos_meto_xc40_n48_glomap_clim_comp_check_16x9]]
        inherit = METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_comp_check_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT160M

    # Atmosphere 12x12 two day model Run for proc comparison
    [[atmos_meto_xc40_n48_glomap_clim_comp_check_12x12]]
        inherit = METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_12x12, IOS_0, UM_N48_GLOMAP_CLIM
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_glomap_clim_comp_check_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT160M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_glomap_clim_comp_check_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GLOMAP_CLIM_COMP_CHECK_DIR
            DIR1=../recon_meto_xc40_n48_glomap_clim_comp_check_2x4
            KGO=0

    [[rose_ana_meto_xc40_n48_glomap_clim_comp_check_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40, ROSE_ANA_N48_GLOMAP_CLIM
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GLOMAP_CLIM_COMP_CHECK_DIR
            DIR1=../atmos_meto_xc40_n48_glomap_clim_comp_check_16x9
            KGO=0

    [[rose_ana_meto_xc40_n48_glomap_clim_comp_check_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_glomap_clim_comp_check_2x4
            DIR1=../recon_meto_xc40_n48_glomap_clim_comp_check_4x2
            KGO=

    [[rose_ana_meto_xc40_n48_glomap_clim_comp_check_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GLOMAP_CLIM_COMP_CHECK, METO_XC40, ROSE_ANA_N48_GLOMAP_CLIM
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_glomap_clim_comp_check_16x9
            DIR1=../atmos_meto_xc40_n48_glomap_clim_comp_check_12x12
            KGO=

{%- endif %}


{% if "meto_xc40_n216_ga6p1_glu" in name_graphs_out -%}
# XC40 N216 GA6.1 GLU (standard IAU)
    [[METO_XC40_N216_GA6P1_GLU]]
        script = "{{TASK_RUN}} --verbose {{UM_XC40_CCE_FAST_OMP}}"
        [[[environment]]]
            KGO_XC40_N216_GA6P1_GLU_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n216_ga6p1_glu/{{XC40_N216_GA6P1_GLU_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n216_ga6p1_glu]]
        script = "{{TASK_RUN_RECON}} --verbose {{UM_XC40_CCE_FAST_OMP}}"
        inherit = METO_XC40_N216_GA6P1_GLU, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x8, UM_N216_GA6P1_GLU
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=daily_recon
            ASTART=../recon_meto_xc40_n216_ga6p1_glu/atmos.astart
        [[[directives]]]
            -l mem = 14GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n216_ga6p1_glu_6x35]]
        inherit = METO_XC40_N216_GA6P1_GLU, METO_XC40_IOS_ON, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x35, IOS_6, UM_N216_GA6P1_GLU
        [[[environment]]]
            ASTART=../recon_meto_xc40_n216_ga6p1_glu/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    # Comparison tasks
    [[rose_ana_meto_xc40_n216_ga6p1_glu_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N216_GA6P1_GLU, METO_XC40, ROSE_ANA_N216_GA6P1_GLU
        [[[environment]]]
            DIR0=$KGO_XC40_N216_GA6P1_GLU_DIR
            DIR1=../atmos_meto_xc40_n216_ga6p1_glu_6x35
            KGO=0

    # Comparison tasks
    [[rose_ana_meto_xc40_n216_ga6p1_glu_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_N216_GA6P1_GLU, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n216_ga6p1_glu_6x35
            DIR1=$KGO_XC40_N216_GA6P1_GLU_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1

    [[rose_ana_meto_xc40_n216_ga6p1_glu_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N216_GA6P1_GLU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N216_GA6P1_GLU_DIR
            DIR1=../recon_meto_xc40_n216_ga6p1_glu
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_n216_ga6p1_glu_reprod_6x36]]
        inherit = METO_XC40_N216_GA6P1_GLU, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x36, IOS_0, UM_N216_GA6P1_GLU
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_n216_ga6p1_glu/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod
        [[[job]]]
            execution time limit = PT13M

    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_n216_ga6p1_glu_reprod_12x18]]
        inherit = METO_XC40_N216_GA6P1_GLU, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x18, IOS_0, UM_N216_GA6P1_GLU
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_n216_ga6p1_glu/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod
        [[[job]]]
            execution time limit = PT10M

    # Comparison task
    [[rose_ana_meto_xc40_n216_ga6p1_glu_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N216_GA6P1_GLU, METO_XC40, ROSE_ANA_N216_GA6P1_GLU
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n216_ga6p1_glu_reprod_6x36
            DIR1=../atmos_meto_xc40_n216_ga6p1_glu_reprod_12x18
            KGO=

{%- endif %}

{%- endif %}


{% if "meto_xc40_n216_ga6p1_glu_4diau" in name_graphs_out -%}
# XC40 N216 GA6.1 GLU (4DIAU)
    [[METO_XC40_N216_GA6P1_GLU_4DIAU]]
        script = "{{TASK_RUN}} --verbose {{UM_XC40_CCE_FAST_OMP}}"
        [[[environment]]]
            KGO_XC40_N216_GA6P1_GLU_4DIAU_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n216_ga6p1_glu_4diau/{{XC40_N216_GA6P1_GLU_4DIAU_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n216_ga6p1_glu_4diau]]
        script = "{{TASK_RUN_RECON}} --verbose {{UM_XC40_CCE_FAST_OMP}}"
        inherit = METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x8, UM_N216_GA6P1_GLU
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=daily_recon
            ASTART=../recon_meto_xc40_n216_ga6p1_glu_4diau/atmos.astart
        [[[directives]]]
            -l mem = 14GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n216_ga6p1_glu_4diau_6x35]]
        inherit = METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40_IOS_ON, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x35, IOS_6, UM_N216_GA6P1_GLU
        [[[environment]]]
            ASTART=../recon_meto_xc40_n216_ga6p1_glu_4diau/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=4diau
        [[[job]]]
            execution time limit = PT10M

    # Comparison tasks
    [[rose_ana_meto_xc40_n216_ga6p1_glu_4diau_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40, ROSE_ANA_N216_GA6P1_GLU
        [[[environment]]]
            DIR0=$KGO_XC40_N216_GA6P1_GLU_4DIAU_DIR
            DIR1=../atmos_meto_xc40_n216_ga6p1_glu_4diau_6x35
            KGO=0

    # Comparison tasks
    [[rose_ana_meto_xc40_n216_ga6p1_glu_4diau_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n216_ga6p1_glu_4diau_6x35
            DIR1=$KGO_XC40_N216_GA6P1_GLU_4DIAU_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1

    [[rose_ana_meto_xc40_n216_ga6p1_glu_4diau_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N216_GA6P1_GLU_4DIAU_DIR
            DIR1=../recon_meto_xc40_n216_ga6p1_glu_4diau
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_n216_ga6p1_glu_4diau_reprod_6x36]]
        inherit = METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x36, IOS_0, UM_N216_GA6P1_GLU
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_n216_ga6p1_glu_4diau/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod 4diau
        [[[job]]]
            execution time limit = PT13M

    # Atmosphere Model Run for proc comparison
    [[atmos_meto_xc40_n216_ga6p1_glu_4diau_reprod_12x18]]
        inherit = METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x18, IOS_0, UM_N216_GA6P1_GLU
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            ASTART=../recon_meto_xc40_n216_ga6p1_glu_4diau/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=reprod 4diau
        [[[job]]]
            execution time limit = PT10M

    # Comparison task
    [[rose_ana_meto_xc40_n216_ga6p1_glu_4diau_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N216_GA6P1_GLU_4DIAU, METO_XC40, ROSE_ANA_N216_GA6P1_GLU
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n216_ga6p1_glu_4diau_reprod_6x36
            DIR1=../atmos_meto_xc40_n216_ga6p1_glu_4diau_reprod_12x18
            KGO=
{%- endif %}

{%- endif %}


{% if "meto_xc40_ukca_eg_strattrop" in name_graphs_out -%}
# HadGEM UKCA EG STRATTROP
    [[METO_XC40_UKCA_EG_STRATTROP]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_UKCA_EG_STRATTROP_DIR={{KGO_XC40_ROOT_DIR}}/xc40_ukca_eg_strattrop/{{XC40_UKCA_EG_STRATTROP_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_ukca_eg_strattrop]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_UKCA_EG_STRATTROP, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop/atmos.astart
        [[[job]]]
            execution time limit = PT66M

    # Atmosphere Model Run 2days -2 OpenMP threads
    [[atmos_meto_xc40_ukca_strattrop_16x9_2omp]]
        inherit = METO_XC40_UKCA_EG_STRATTROP, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop/atmos.astart
        [[[job]]]
            execution time limit = PT66M

    # Atmosphere Model Run 1day NRUN
    [[atmos_meto_xc40_ukca_strattrop_nrun_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop/atmos.astart
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP
            ROSE_APP_OPT_CONF_KEYS= nrun
        [[[job]]]
            execution time limit = PT22M

    # Atmosphere Model Run 1day CRUN
    [[atmos_meto_xc40_ukca_strattrop_crun_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP
        [[[job]]]
            execution time limit = PT22M

    # Comparison tasks
    [[rose_ana_meto_xc40_ukca_eg_strattrop_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_DIR
            DIR1=../recon_meto_xc40_ukca_eg_strattrop
            KGO=0
            
    [[rose_ana_meto_xc40_ukca_eg_strattrop_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_DIR
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_16x9
            KGO=0

    [[rose_ana_meto_xc40_ukca_strattrop_atmos_thread]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_ukca_strattrop_16x9_2omp
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_16x9
            KGO=

    [[rose_ana_meto_xc40_ukca_strattrop_atmos_nruncrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_16x9
            KGO=
            ROSE_APP_OPT_CONF_KEYS= nruncrun
           
{%- endif %}


{% if "meto_xc40_ukca_eg_strattrop_safe" in name_graphs_out -%}
# HadGEM UKCA EG STRATTROP_SAFE
    [[METO_XC40_UKCA_EG_STRATTROP_SAFE]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_UKCA_EG_STRATTROP_SAFE_DIR={{KGO_XC40_ROOT_DIR}}/xc40_ukca_eg_strattrop_safe/{{XC40_UKCA_EG_STRATTROP_SAFE_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_ukca_eg_strattrop_safe_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_safe_2x4/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_safe_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_safe_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT30M

    # Atmosphere Model Run 2days -2 OpenMP threads
    [[atmos_meto_xc40_ukca_eg_strattrop_safe_16x9_2omp]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_safe_2x4/atmos.astart
        [[[job]]]
            execution time limit = PT20M

    # Atmosphere Model Run 1day NRUN
    [[atmos_meto_xc40_ukca_eg_strattrop_safe_nrun_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_safe_2x4/atmos.astart
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP_SAFE
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP_SAFE
            ROSE_APP_OPT_CONF_KEYS= nrun
        [[[job]]]
            execution time limit = PT20M

    # Atmosphere Model Run 1day CRUN
    [[atmos_meto_xc40_ukca_eg_strattrop_safe_crun_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP_SAFE
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP_SAFE
        [[[job]]]
            execution time limit = PT20M

    # Comparison tasks
    [[rose_ana_meto_xc40_ukca_eg_strattrop_safe_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_SAFE_DIR
            DIR1=../recon_meto_xc40_ukca_eg_strattrop_safe_2x4
            KGO=0
            
    [[rose_ana_meto_xc40_ukca_eg_strattrop_safe_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_SAFE_DIR
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_safe_16x9
            KGO=0

    [[rose_ana_meto_xc40_ukca_eg_strattrop_safe_atmos_thread]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_ukca_eg_strattrop_safe_16x9_2omp
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_safe_16x9
            KGO=

    [[rose_ana_meto_xc40_ukca_eg_strattrop_safe_atmos_nruncrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_SAFE, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_UKCA_STRATTROP_SAFE
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_safe_16x9
            KGO=
            ROSE_APP_OPT_CONF_KEYS= nruncrun
           
{%- endif %}


{% if "meto_xc40_ukca_eg_strattrop_columns" in name_graphs_out -%}
# HadGEM UKCA EG STRATTROP
    [[METO_XC40_UKCA_EG_STRATTROP_COLUMNS]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_DIR={{KGO_XC40_ROOT_DIR}}/xc40_ukca_eg_strattrop_columns/{{XC40_UKCA_EG_STRATTROP_COLUMNS_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_ukca_eg_strattrop_columns_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_2x4/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_columns_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_2x4/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT30M

    # Atmosphere Model Run 2days -2 OpenMP threads
    [[atmos_meto_xc40_ukca_strattrop_columns_16x9_2omp]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_2x4/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT20M

    # Comparison tasks
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_DIR
            DIR1=../recon_meto_xc40_ukca_eg_strattrop_columns_2x4
            KGO=0
            
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_DIR
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_16x9
            KGO=0

    [[rose_ana_meto_xc40_ukca_strattrop_columns_atmos_thread]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_ukca_strattrop_columns_16x9_2omp
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_16x9
            KGO=

    # Atmosphere Model Run for proc comparison

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_columns_12x12]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_12x12, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_2x4/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT80M

    [[rose_ana_meto_xc40_ukca_strattrop_columns_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_ukca_eg_strattrop_columns_12x12
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_16x9
            KGO=
           
{%- endif %}


{% if "meto_xc40_ukca_eg_strattrop_columns_safe" in name_graphs_out -%}
# HadGEM UKCA EG STRATTROP COLUMNS SAFE
    [[METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_DIR={{KGO_XC40_ROOT_DIR}}/xc40_ukca_eg_strattrop_columns_safe/{{XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_KGO}}

    # Reconfiguration 2x4
    [[recon_meto_xc40_ukca_eg_strattrop_columns_safe_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_2x4/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Reconfiguration 4x2
    [[recon_meto_xc40_ukca_eg_strattrop_columns_safe_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_4x2/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_columns_safe_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_2x4/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT30M

    # Atmosphere Model Run 2days -2 OpenMP threads
    [[atmos_meto_xc40_ukca_eg_strattrop_columns_safe_16x9_2omp]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_2x4/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT20M

    # Comparison tasks
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_DIR
            DIR1=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_2x4
            KGO=0
            
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_DIR
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_safe_16x9
            KGO=0

    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_atmos_thread]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_ukca_eg_strattrop_columns_safe_16x9_2omp
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_safe_16x9
            KGO=

    # Atmosphere Model Run for proc comparison

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_columns_safe_12x12]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_12x12, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_4x2/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT20M

    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_2x4
            DIR1=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_4x2
            KGO=
           
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_ukca_eg_strattrop_columns_safe_12x12
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_safe_16x9
            KGO=
           
{%- endif %}


{% if "meto_xc40_ukca_eg_strattrop_columns_safe_noomp" in name_graphs_out -%}
# HadGEM UKCA EG STRATTROP COLUMNS SAFE NOOMP - use the same KGO_DIR as for the OMP job
    [[METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_NOOMP]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_NOOMP }}"
        [[[environment]]]
            KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_DIR={{KGO_XC40_ROOT_DIR}}/xc40_ukca_eg_strattrop_columns_safe/{{XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_KGO}}

    # Reconfiguration 2x4
    [[recon_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_NOOMP }}"
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_NOOMP, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_2x4/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Atmosphere Model Run 2days -1 thread
    [[atmos_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_16x9]]
        inherit = METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_NOOMP, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_2x4/atmos.astart
	    ROSE_APP_OPT_CONF_KEYS= col
        [[[job]]]
            execution time limit = PT30M

    # Comparison tasks
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_NOOMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_DIR
            DIR1=../recon_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_2x4
            KGO=0
            
    [[rose_ana_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_NOOMP, METO_XC40, ROSE_ANA_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_EG_STRATTROP_COLUMNS_SAFE_DIR
            DIR1=../atmos_meto_xc40_ukca_eg_strattrop_columns_safe_noomp_16x9
            KGO=0
           
{%- endif %}


{% if "meto_xc40_ukca_nudged" in name_graphs_out -%}
# HadGEM UKCA EG NUDGED
    [[METO_XC40_UKCA_NUDGED]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_UKCA_NUDGED_DIR={{KGO_XC40_ROOT_DIR}}/xc40_ukca_nudged/{{XC40_UKCA_NUDGED_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_ukca_nudged]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_UKCA_NUDGED, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_UKCA_NUDGED
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_nudged/atmos.astart
        [[[directives]]]
            -l mem = 12GB
        [[[job]]]
            execution time limit = PT6M

    # Atmosphere Model Run
    [[atmos_meto_xc40_ukca_nudged_16x9]]
        inherit = METO_XC40_UKCA_NUDGED, METO_XC40_IOS_OFF, METO_XC40_CORES_144, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_UKCA_NUDGED
        [[[environment]]]
            ASTART=../recon_meto_xc40_ukca_nudged/atmos.astart
        [[[job]]]
            execution time limit = PT66M

    # Comparison tasks
    [[rose_ana_meto_xc40_ukca_nudged_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_NUDGED, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_NUDGED_DIR
            DIR1=../recon_meto_xc40_ukca_nudged
            KGO=0

    [[rose_ana_meto_xc40_ukca_nudged_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_UKCA_NUDGED, METO_XC40, ROSE_ANA_UKCA_NUDGED
        [[[environment]]]
            DIR0=$KGO_XC40_UKCA_NUDGED_DIR
            DIR1=../atmos_meto_xc40_ukca_nudged_16x9
            KGO=0

{%- endif %}


    [[XC40_IDEALISED_EXO]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_IDEALISED_EXO_ISO_HD209_DIR={{KGO_XC40_ROOT_DIR}}/xc40_idealised_exo_iso_hd209/{{XC40_IDEALISED_EXO_ISO_HD209_KGO}}
            KGO_IDEALISED_EXO_SHJ_DIR={{KGO_XC40_ROOT_DIR}}/xc40_idealised_exo_shj/{{XC40_IDEALISED_EXO_SHJ_KGO}}
            KGO_IDEALISED_EXO_EL_RT_DIR={{KGO_XC40_ROOT_DIR}}/xc40_idealised_exo_el_rt/{{XC40_IDEALISED_EXO_EL_RT_KGO}}

{% if "meto_xc40_idealised_exo_iso_hd209" in name_graphs_out -%}
# Idealised Isothermal Hot Jupiter HD209458b

    # Reconfiguration
    [[recon_meto_xc40_idealised_exo_iso_hd209_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_IDEALISED_EXO_HD209
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_iso_hd209_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=isothermal
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run
    [[atmos_meto_xc40_idealised_exo_iso_hd209_4x4]]
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x4, IOS_0, UM_IDEALISED_EXO_HD209
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_iso_hd209_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=isothermal
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT26M

    # Comparison tasks
    [[rose_ana_meto_xc40_idealised_exo_iso_hd209_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_IDEALISED_EXO_ISO_HD209_DIR
            DIR1=../recon_meto_xc40_idealised_exo_iso_hd209_2x1
            KGO=0

    [[rose_ana_meto_xc40_idealised_exo_iso_hd209_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_IDEALISED_EXO
        [[[environment]]]
            DIR0= $KGO_IDEALISED_EXO_ISO_HD209_DIR
            DIR1=../atmos_meto_xc40_idealised_exo_iso_hd209_4x4
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Reconfiguration
    [[recon_meto_xc40_idealised_exo_iso_hd209_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_IDEALISED_EXO_HD209
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_iso_hd209_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=isothermal
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run
    [[atmos_meto_xc40_idealised_exo_iso_hd209_8x2]]
        script = "{{TASK_RUN}}  {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x2, IOS_0, UM_IDEALISED_EXO_HD209
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_iso_hd209_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=isothermal
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT19M

    # Comparison tasks
    [[rose_ana_meto_xc40_idealised_exo_iso_hd209_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_idealised_exo_iso_hd209_2x1
            DIR1=../recon_meto_xc40_idealised_exo_iso_hd209_1x2
            KGO=

    [[rose_ana_meto_xc40_idealised_exo_iso_hd209_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_IDEALISED_EXO
        [[[environment]]]
            DIR0=../atmos_meto_xc40_idealised_exo_iso_hd209_8x2
            DIR1=../atmos_meto_xc40_idealised_exo_iso_hd209_4x4
            KGO=
    
{%- endif %}

{%- endif %}


{% if "meto_xc40_idealised_exo_shj" in name_graphs_out -%}
# Idealised Shallow Hot Jupiter

    # Reconfiguration
    [[recon_meto_xc40_idealised_exo_shj_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_IDEALISED_EXO_SHJ
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_shj_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run
    [[atmos_meto_xc40_idealised_exo_shj_4x4]]
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x4, IOS_0, UM_IDEALISED_EXO_SHJ
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_shj_2x1/atmos.astart
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT26M

    # Comparison tasks
    [[rose_ana_meto_xc40_idealised_exo_shj_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_IDEALISED_EXO_SHJ_DIR
            DIR1=../recon_meto_xc40_idealised_exo_shj_2x1
            KGO=0

    [[rose_ana_meto_xc40_idealised_exo_shj_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_IDEALISED_EXO
        [[[environment]]]
            DIR0=$KGO_IDEALISED_EXO_SHJ_DIR
            DIR1=../atmos_meto_xc40_idealised_exo_shj_4x4
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Reconfiguration
    [[recon_meto_xc40_idealised_exo_shj_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_IDEALISED_EXO_SHJ
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_shj_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run
    [[atmos_meto_xc40_idealised_exo_shj_8x2]]
        script = "{{TASK_RUN}}  {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x2, IOS_0, UM_IDEALISED_EXO_SHJ
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_shj_2x1/atmos.astart
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT19M

    # Comparison tasks
    [[rose_ana_meto_xc40_idealised_exo_shj_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_idealised_exo_shj_2x1
            DIR1=../recon_meto_xc40_idealised_exo_shj_1x2
            KGO=

    [[rose_ana_meto_xc40_idealised_exo_shj_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_IDEALISED_EXO
        [[[environment]]]
            DIR0=../atmos_meto_xc40_idealised_exo_shj_8x2
            DIR1=../atmos_meto_xc40_idealised_exo_shj_4x4
            KGO=
    
{%- endif %}

{%- endif %}


{% if "meto_xc40_idealised_exo_el_rt" in name_graphs_out -%}
# Idealised Earth-like Exoplanet with radiative transfer

    # Reconfiguration
    [[recon_meto_xc40_idealised_exo_el_rt_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_IDEALISED_EXO_EL
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_el_rt_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT8M

    # Atmosphere Model Run
    [[atmos_meto_xc40_idealised_exo_el_rt_4x4]]
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x4, IOS_0, UM_IDEALISED_EXO_EL
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_el_rt_2x1/atmos.astart
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT26M

    # Comparison tasks
    [[rose_ana_meto_xc40_idealised_exo_el_rt_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_IDEALISED_EXO_EL_RT_DIR
            DIR1=../recon_meto_xc40_idealised_exo_el_rt_2x1
            KGO=0

    [[rose_ana_meto_xc40_idealised_exo_el_rt_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_IDEALISED_EXO
        [[[environment]]]
            DIR0=$KGO_IDEALISED_EXO_EL_RT_DIR
            DIR1=../atmos_meto_xc40_idealised_exo_el_rt_4x4
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Reconfiguration
    [[recon_meto_xc40_idealised_exo_el_rt_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_IDEALISED_EXO_EL
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_el_rt_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT8M

    # Atmosphere Model Run
    [[atmos_meto_xc40_idealised_exo_el_rt_8x2]]
        script = "{{TASK_RUN}}  {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = XC40_IDEALISED_EXO, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x2, IOS_0, UM_IDEALISED_EXO_EL
        [[[environment]]]
            ASTART=../recon_meto_xc40_idealised_exo_el_rt_2x1/atmos.astart
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT19M

    # Comparison tasks
    [[rose_ana_meto_xc40_idealised_exo_el_rt_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_idealised_exo_el_rt_2x1
            DIR1=../recon_meto_xc40_idealised_exo_el_rt_1x2
            KGO=

    [[rose_ana_meto_xc40_idealised_exo_el_rt_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, XC40_IDEALISED_EXO, METO_XC40, ROSE_ANA_IDEALISED_EXO
        [[[environment]]]
            DIR0=../atmos_meto_xc40_idealised_exo_el_rt_8x2
            DIR1=../atmos_meto_xc40_idealised_exo_el_rt_4x4
            KGO=
    
{%- endif %}

{%- endif %}


       
{% if "meto_xc40_n48_ga7_amip_2day" in name_graphs_out -%}

# N48 GA7_AMIP "climate" configuration - 2 day variant
    [[METO_XC40_N48_GA7_AMIP_2DAY]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_2DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_2day/{{XC40_N48_GA7_AMIP_2DAY_KGO}}

# N48 GA7_AMIP "climate" configuration - single precision variant
    [[METO_XC40_N48_GA7_AMIP_SP_PHYSICS]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP_SP_PHYSICS }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_SP_PHYSICS_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_sp_physics/{{XC40_N48_GA7_AMIP_SP_PHYSICS_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga7_amip_2day_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga7_amip_2day_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf in (["",        ""], 
                                 ["_nc3",    "netcdf netcdf3"],
                                 ["_nc4",    "netcdf netcdf4"],
                                 ["_nc4_32", "netcdf netcdf4-32b"]) %}

    [[atmos_meto_xc40_n48_ga7_amip_2day{{extension}}_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day {{opt_conf}}
        [[[job]]]
            execution time limit = PT49M

  {%- endfor %}

    [[recon_meto_xc40_n48_ga7_amip_sp_physics_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP_SP_PHYSICS }}"
        inherit = METO_XC40_N48_GA7_AMIP_SP_PHYSICS, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_sp_physics_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga7_amip_sp_physics_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP_SP_PHYSICS }}"
        inherit = METO_XC40_N48_GA7_AMIP_SP_PHYSICS, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_sp_physics_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga7_amip_2day_4x9]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT49M

    [[atmos_meto_xc40_n48_ga7_amip_2day_4x9_1thread]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_36, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT99M

    [[atmos_meto_xc40_n48_ga7_amip_2day_4x9_noomp]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_NOOMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_36, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT99M

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf in (["",        ""], 
                                 ["_nc3",    "netcdf netcdf3"],
                                 ["_nc4",    "netcdf netcdf4"],
                                 ["_nc4_32", "netcdf netcdf4-32b"]) %}

    # CRUN test
    [[atmos_meto_xc40_n48_ga7_amip_1day_NRUN{{extension}}_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2/atmos.astart
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA7_AMIP_2DAY{{extension}}
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA7_AMIP_2DAY{{extension}}
            ROSE_APP_OPT_CONF_KEYS=n48 nrun {{opt_conf}}
        [[[job]]]
            execution time limit = PT9M

    [[atmos_meto_xc40_n48_ga7_amip_1day_CRUN{{extension}}_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA7_AMIP_2DAY{{extension}}
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA7_AMIP_2DAY{{extension}}
            # Optional configurations for "n48 2day" is the default
            ROSE_APP_OPT_CONF_KEYS=n48 2day {{opt_conf}}
        [[[job]]]
            execution time limit = PT9M

  {%- endfor %}
            
    # NRUN plus NRUN tasks
    [[recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun_restart]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA7_AMIP
        [[[environment]]]
            AINITIAL=../atmos_meto_xc40_n48_ga7_amip_1day_NRUN1_6x6/atmosa.da19810902_00
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun_restart/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base  
        [[[job]]]
            execution time limit = PT5M
    
    [[atmos_meto_xc40_n48_ga7_amip_2day_LRUN_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base
        [[[job]]]
            execution time limit = PT49M
    
    [[atmos_meto_xc40_n48_ga7_amip_1day_NRUN1_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base nrun1
        [[[job]]]
            execution time limit = PT22M

    [[atmos_meto_xc40_n48_ga7_amip_1day_NRUN2_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../atmos_meto_xc40_n48_ga7_amip_1day_NRUN1_6x6/atmosa.da19810902_00
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base nrun2
        [[[job]]]
            execution time limit = PT22M

    [[atmos_meto_xc40_n48_ga7_amip_sp_physics_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_SP_PHYSICS, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_sp_physics_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT49M

    [[atmos_meto_xc40_n48_ga7_amip_sp_physics_4x9]]
        inherit = METO_XC40_N48_GA7_AMIP_SP_PHYSICS, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_sp_physics_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT49M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga7_amip_2day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga7_amip_2day_4x9
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day_6x6
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_2day_atmos_thread]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga7_amip_2day_4x9
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day_4x9_1thread
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_2day_atmos_omp]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day        
            DIR0=../atmos_meto_xc40_n48_ga7_amip_2day_4x9
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day_4x9_noomp
            KGO=

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf, kgo_subdir in (["",        "",       ""], 
                                             ["_nc3",    "netcdf", "/netcdf-3/"],
                                             ["_nc4",    "netcdf", "/netcdf-4/"],
                                             ["_nc4_32", "netcdf", "/netcdf-4_32bit/"]) %}

    [[rose_ana_meto_xc40_n48_ga7_amip_2day{{extension}}_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day {{opt_conf}}
            DIR0=$KGO_XC40_N48_GA7_AMIP_2DAY_DIR{{kgo_subdir}}
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day{{extension}}_6x6
            KGO=0

  {%- endfor %}

    [[rose_ana_meto_xc40_n48_ga7_amip_2day_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ga7_amip_2day_4x2
            DIR1=../recon_meto_xc40_n48_ga7_amip_2day_2x4
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_2day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_2DAY_DIR
            DIR1=../recon_meto_xc40_n48_ga7_amip_2day_4x2
            KGO=0
            
    [[rose_ana_meto_xc40_n48_ga7_amip_recon_after_nrun_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_2day/{{XC40_N48_GA7_AMIP_2DAY_KGO}}/recon_after_nrun
            DIR1=../recon_meto_xc40_n48_ga7_amip_2day_4x2_nrunPlusNrun_restart
            KGO=0

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf in (["",        ""], 
                                 ["_nc3",    "netcdf"],
                                 ["_nc4",    "netcdf"],
                                 ["_nc4_32", "netcdf"]) %}

    [[rose_ana_meto_xc40_n48_ga7_amip_2day{{extension}}_atmos_nruncrun_lrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA7_AMIP_2DAY{{extension}}
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day{{extension}}_6x6
            ROSE_APP_OPT_CONF_KEYS=nruncrun_lrun 2day {{opt_conf}}
            KGO=

  {%- endfor %}

    [[rose_ana_meto_xc40_n48_ga7_amip_2day_atmos_nrunplusnrun_lrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP_NRUN_NRUN
        [[[environment]]]
            DIR1=${CYLC_SUITE_RUN_DIR}/work/1/atmos_meto_xc40_n48_ga7_amip_2day_LRUN_6x6/
            DIR2=${CYLC_SUITE_RUN_DIR}/work/1/atmos_meto_xc40_n48_ga7_amip_1day_NRUN1_6x6/
            DIR3=${CYLC_SUITE_RUN_DIR}/work/1/atmos_meto_xc40_n48_ga7_amip_1day_NRUN2_6x6/

    [[rose_ana_meto_xc40_n48_ga7_amip_sp_physics_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_SP_PHYSICS, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ga7_amip_sp_physics_4x9
            DIR1=../atmos_meto_xc40_n48_ga7_amip_sp_physics_6x6
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_sp_physics_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_SP_PHYSICS, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_SP_PHYSICS_DIR
            DIR1=../atmos_meto_xc40_n48_ga7_amip_sp_physics_6x6
            KGO=0


{%- endif %}

{% if "meto_xc40_n48_ga7_amip_2day_nrchem" in name_graphs_out -%}

# N48 GA7_AMIP "climate" configuration - 2 day variant
    [[METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_2DAY_NRCHEM_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_2day_nrchem/{{XC40_N48_GA7_AMIP_2DAY_NRCHEM_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga7_amip_2day_nrchem_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_nrchem_2x4/atmos.astart
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga7_amip_2day_nrchem_4x9]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_nrchem_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day nrchem
        [[[job]]]
            execution time limit = PT50M

   # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga7_amip_2day_nrchem_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_2DAY_NRCHEM_DIR
            DIR1=../recon_meto_xc40_n48_ga7_amip_2day_nrchem_2x4
            KGO=0
            
    [[rose_ana_meto_xc40_n48_ga7_amip_2day_nrchem_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=$KGO_XC40_N48_GA7_AMIP_2DAY_NRCHEM_DIR
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day_nrchem_4x9
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Atmosphere Model Run for proc comparison

    [[atmos_meto_xc40_n48_ga7_amip_2day_nrchem_6x6]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_nrchem_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day nrchem
        [[[job]]]
            execution time limit = PT50M

   # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga7_amip_2day_nrchem_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY_NRCHEM, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga7_amip_2day_nrchem_6x6
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day_nrchem_4x9
            KGO=

{%- endif %}

{%- endif %}


{% if "meto_xc40_n48_ga7_amip_naming" in name_graphs_out %}
# N48 special configuration for testing file naming schemes

    [[METO_XC40_N48_GA7_AMIP_NAMING]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_NAMING_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_naming/{{XC40_N48_GA7_AMIP_NAMING_KGO}}


    [[recon_meto_xc40_n48_ga7_amip_naming_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_naming_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS = naming-base
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga7_amip_naming_4x9]]
        inherit = METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_naming_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS = n48 naming-base
        [[[job]]]
            execution time limit = PT49M

    [[rose_ana_meto_xc40_n48_ga7_amip_naming_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40, ROSE_ANA_N48_GA7_AMIP_NAMING
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_NAMING_DIR
            DIR1=../atmos_meto_xc40_n48_ga7_amip_naming_4x9
            KGO=0
        [[[directives]]]
            -l mem = 2GB

    [[rose_ana_meto_xc40_n48_ga7_amip_naming_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_NAMING_DIR
            DIR1=../recon_meto_xc40_n48_ga7_amip_naming_2x4
            KGO=0

    # Namespace families for the install and archiving
    [[XC40_GA7_AMIP_NAMING_CRUN_INSTALL, XC40_GA7_AMIP_NAMING_CRUN_ARCHIVE]]

    # Atmosphere model NRUN
    [[atmos_meto_xc40_n48_ga7_amip_naming_crun_4x9_0]]
        inherit = METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_naming_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS = n48 naming-base naming-nrun
        [[[job]]]
            execution time limit = PT49M

    {% for crun_no in range(1,4) %}
        
        # Atmosphere model CRUNs
        [[atmos_meto_xc40_n48_ga7_amip_naming_crun_4x9_{{crun_no}}]]
            inherit = METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
            [[[environment]]]
                ASTART=../recon_meto_xc40_n48_ga7_amip_naming_2x4/atmos.astart
                ROSE_APP_OPT_CONF_KEYS = n48 naming-base naming-crun{{crun_no}}
                CONTINUE=true
            [[[job]]]
                execution time limit = PT49M

        # Task which moves results forwards
        [[meto_xc40_ga7_amip_naming_crun_install_{{crun_no}}]]
            inherit = XC40_GA7_AMIP_NAMING_CRUN_INSTALL
            script = """
            $CYLC_SUITE_RUN_DIR/app/um_ga7_amip/bin/crun_install.sh
            """
            [[[environment]]]
                ATMOS_PREV=atmos_meto_xc40_n48_ga7_amip_naming_crun_4x9_{{crun_no - 1}}
                ATMOS_NEW=atmos_meto_xc40_n48_ga7_amip_naming_crun_4x9_{{crun_no}}
            [[[remote]]]
                host = $(rose host-select {{ HOST_XC40 }})

    {% endfor %}

    {% for crun_no in range(0,4) %}

        # Task which moves files to "archive" folder
        [[meto_xc40_ga7_amip_naming_crun_archive_{{crun_no}}]]
            inherit = XC40_GA7_AMIP_NAMING_CRUN_ARCHIVE
            script = """
            $CYLC_SUITE_RUN_DIR/app/um_ga7_amip/bin/crun_archive.sh
            """
            [[[environment]]]
                ARCHIVE_DIR=$CYLC_SUITE_SHARE_DIR/N48_GA7_AMIP_NAMING_CRUN_XC40
                ATMOS_DIR=atmos_meto_xc40_n48_ga7_amip_naming_crun_4x9_{{crun_no}}
                CRUN_NO={{crun_no}}
            [[[remote]]]
                host = $(rose host-select {{ HOST_XC40 }})

    {% endfor %}

    # Comparison task for the final point of the CRUNs
    [[rose_ana_meto_xc40_n48_ga7_amip_naming_lrun_crun_atmos]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_NAMING, METO_XC40, ROSE_ANA_N48_GA7_AMIP_NAMING
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ga7_amip_naming_4x9
            DIR1=$CYLC_SUITE_SHARE_DIR/N48_GA7_AMIP_NAMING_CRUN_XC40
            KGO=
        [[[directives]]]
            -l mem = 2GB

{% endif %}

{% if "meto_xc40_n48_ga7_amip_2day_comp_check" in name_graphs_out -%}
# N48 GA7_AMIP "climate" configuration - 2-day variant with rigorous compiler optimisation
    [[METO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_2day_comp_check/{{XC40_N48_GA7_AMIP_2DAY_COMP_CHECK_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga7_amip_2day_comp_check_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_comp_check_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga7_amip_2day_comp_check_4x9]]
        inherit = METO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_2day_comp_check_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT99M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga7_amip_2day_comp_check_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=$KGO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK_DIR
            DIR1=../atmos_meto_xc40_n48_ga7_amip_2day_comp_check_4x9
            KGO=0

    [[rose_ana_meto_xc40_n48_ga7_amip_2day_comp_check_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_2DAY_COMP_CHECK_DIR
            DIR1=../recon_meto_xc40_n48_ga7_amip_2day_comp_check_2x4
            KGO=0

{%- endif %}

{% if "meto_xc40_n48_ga7_amip_10day" in name_graphs_out -%}
# N48 GA7_AMIP "climate" configuration - 10-day variant using 'HIGH'
    [[METO_XC40_N48_GA7_AMIP_10DAY]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_10DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_10day/{{XC40_N48_GA7_AMIP_10DAY_KGO}}
            
    # Reconfiguration
    [[recon_meto_xc40_n48_ga7_amip_10day_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_10day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga7_amip_10day_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_10day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga7_amip_10day_12x9]]
        inherit = METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_216, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_10day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[job]]]
            execution time limit = PT66M

    [[atmos_meto_xc40_n48_ga7_amip_10day_16x9]]
        inherit = METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_10day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[job]]]
            execution time limit = PT66M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga7_amip_10day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=10day
            DIR0=../atmos_meto_xc40_n48_ga7_amip_10day_16x9
            DIR1=../atmos_meto_xc40_n48_ga7_amip_10day_12x9
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_10day_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=10day
            DIR0=$KGO_XC40_N48_GA7_AMIP_10DAY_DIR
            DIR1=../atmos_meto_xc40_n48_ga7_amip_10day_12x9
            KGO=0

    [[rose_ana_meto_xc40_n48_ga7_amip_10day_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ga7_amip_10day_4x2
            DIR1=../recon_meto_xc40_n48_ga7_amip_10day_2x4
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_10day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_10DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_10DAY_DIR
            DIR1=../recon_meto_xc40_n48_ga7_amip_10day_2x4
            KGO=0

{%- endif %}


{% if "meto_xc40_n48_ga7_amip_30day" in name_graphs_out -%}
# N48 GA7_AMIP "climate" configuration - 30-day variant
    [[METO_XC40_N48_GA7_AMIP_30DAY]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA7_AMIP_30DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga7_amip_30day/{{XC40_N48_GA7_AMIP_30DAY_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga7_amip_30day_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_30day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga7_amip_30day_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_30day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga7_amip_30day_12x9]]
        inherit = METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_216, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_30day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[job]]]
            execution time limit = PT99M

    [[atmos_meto_xc40_n48_ga7_amip_30day_16x9]]
        inherit = METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_GA7_AMIP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga7_amip_30day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[job]]]
            execution time limit = PT99M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga7_amip_30day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=30day
            DIR0=../atmos_meto_xc40_n48_ga7_amip_30day_16x9
            DIR1=../atmos_meto_xc40_n48_ga7_amip_30day_12x9
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_30day_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40, ROSE_ANA_N48_GA7_AMIP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=30day
            DIR0=$KGO_XC40_N48_GA7_AMIP_30DAY_DIR
            DIR1=../atmos_meto_xc40_n48_ga7_amip_30day_12x9
            KGO=0

    [[rose_ana_meto_xc40_n48_ga7_amip_30day_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ga7_amip_30day_4x2
            DIR1=../recon_meto_xc40_n48_ga7_amip_30day_2x4
            KGO=

    [[rose_ana_meto_xc40_n48_ga7_amip_30day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA7_AMIP_30DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA7_AMIP_30DAY_DIR
            DIR1=../recon_meto_xc40_n48_ga7_amip_30day_2x4
            KGO=0

{%- endif %}


{% if "meto_xc40_n48_ga_amip_exp_2day" in name_graphs_out -%}
# N48 GA_AMIP_EXP "climate" configuration - 2 day variant
    [[METO_XC40_N48_GA_AMIP_EXP_2DAY]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_2DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_2day/{{XC40_N48_GA_AMIP_EXP_2DAY_KGO}}

# N48 GA_AMIP_EXP "climate" configuration - single precision variant
    [[METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP_SP_PHYSICS }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_sp_physics/{{XC40_N48_GA_AMIP_EXP_SP_PHYSICS_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga_amip_exp_2day_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga_amip_exp_2day_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M
            
    [[recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun ]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base
        [[[job]]]
            execution time limit = PT5M
    
    [[recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun_restart]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA_AMIP_EXP
        [[[environment]]]
            AINITIAL=../atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN1_6x6/atmosa.da19810902_00
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun_restart/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base
        [[[job]]]
            execution time limit = PT5M

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf in (["",        ""], 
                                 ["_nc3",    "netcdf netcdf3"],
                                 ["_nc4",    "netcdf netcdf4"],
                                 ["_nc4_32", "netcdf netcdf4-32b"]) %}

    [[atmos_meto_xc40_n48_ga_amip_exp_2day{{extension}}_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day {{opt_conf}}
        [[[job]]]
            execution time limit = PT49M

  {%- endfor %}

    [[recon_meto_xc40_n48_ga_amip_exp_sp_physics_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP_SP_PHYSICS }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_sp_physics_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga_amip_exp_sp_physics_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP_SP_PHYSICS }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_sp_physics_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga_amip_exp_2day_4x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT49M

    [[atmos_meto_xc40_n48_ga_amip_exp_2day_4x9_1thread]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_36, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT99M

    [[atmos_meto_xc40_n48_ga_amip_exp_2day_4x9_noomp]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_NOOMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_36, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT99M

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf in (["",        ""], 
                                 ["_nc3",    "netcdf netcdf3"],
                                 ["_nc4",    "netcdf netcdf4"],
                                 ["_nc4_32", "netcdf netcdf4-32b"]) %}

    # CRUN test
    [[atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN{{extension}}_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2/atmos.astart
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA_AMIP_EXP_2DAY{{extension}}
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA_AMIP_EXP_2DAY{{extension}}
            ROSE_APP_OPT_CONF_KEYS=n48 nrun {{opt_conf}}
        [[[job]]]
            execution time limit = PT33M

    [[atmos_meto_xc40_n48_ga_amip_exp_1day_CRUN{{extension}}_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA_AMIP_EXP_2DAY{{extension}}
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA_AMIP_EXP_2DAY{{extension}}
            # Optional configurations for "n48 2day" is the default
            ROSE_APP_OPT_CONF_KEYS=n48 2day {{opt_conf}}
        [[[job]]]
            execution time limit = PT33M

  {%- endfor %}
            
    [[atmos_meto_xc40_n48_ga_amip_exp_2day_LRUN_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base
        [[[job]]]
            execution time limit = PT49M

    [[atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN1_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base nrun1
        [[[job]]]
            execution time limit = PT33M

    [[atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN2_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN1_6x6/atmosa.da19810902_00
            ROSE_APP_OPT_CONF_KEYS=n48 nrun_nrun_lrun_base nrun2
        [[[job]]]
            execution time limit = PT33M

    [[atmos_meto_xc40_n48_ga_amip_exp_sp_physics_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_sp_physics_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT49M

    [[atmos_meto_xc40_n48_ga_amip_exp_sp_physics_4x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_sp_physics_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT49M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_2day_4x9
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day_6x6
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_atmos_thread]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_2day_4x9
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day_4x9_1thread
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_atmos_omp]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_2day_4x9
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day_4x9_noomp
            KGO=

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf, kgo_subdir in (["",        "",       ""], 
                                             ["_nc3",    "netcdf", "/netcdf-3/"],
                                             ["_nc4",    "netcdf", "/netcdf-4/"],
                                             ["_nc4_32", "netcdf", "/netcdf-4_32bit/"]) %}

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day{{extension}}_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day {{opt_conf}}
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_2DAY_DIR{{kgo_subdir}}
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day{{extension}}_6x6
            KGO=0

  {%- endfor %}

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_2day_2x4
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_2DAY_DIR
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2
            KGO=0

  # Repeat this section for various combinations of netcdf library settings
  # (as well as the usual app without netcdf enabled at all)
  {% for extension, opt_conf in (["",        ""], 
                                 ["_nc3",    "netcdf"],
                                 ["_nc4",    "netcdf"],
                                 ["_nc4_32", "netcdf"]) %}

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day{{extension}}_atmos_nruncrun_lrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_GA_AMIP_EXP_2DAY{{extension}}
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day{{extension}}_6x6
            ROSE_APP_OPT_CONF_KEYS=nruncrun_lrun 2day {{opt_conf}}
            KGO=

  {%- endfor %}
            
    [[rose_ana_meto_xc40_n48_ga_amip_exp_recon_after_nrun_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_2day/{{XC40_N48_GA_AMIP_EXP_2DAY_KGO}}/recon_after_nrun
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_2day_4x2_nrunPlusNrun_restart
            KGO=0

    
    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_atmos_nrunplusnrun_lrun]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP_NRUN_NRUN
        [[[environment]]]
            DIR1=${CYLC_SUITE_RUN_DIR}/work/1/atmos_meto_xc40_n48_ga_amip_exp_2day_LRUN_6x6/
            DIR2=${CYLC_SUITE_RUN_DIR}/work/1/atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN1_6x6/
            DIR3=${CYLC_SUITE_RUN_DIR}/work/1/atmos_meto_xc40_n48_ga_amip_exp_1day_NRUN2_6x6/

    [[rose_ana_meto_xc40_n48_ga_amip_exp_sp_physics_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_sp_physics_4x9
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_sp_physics_6x6
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_sp_physics_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_SP_PHYSICS_DIR
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_sp_physics_6x6
            KGO=0

{%- endif %}

{% if "meto_xc40_n48_ga_amip_exp_2day_nrchem" in name_graphs_out -%}

# N48 GA_AMIP_EXP "climate" configuration - 2 day variant
    [[METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_2day_nrchem/{{XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga_amip_exp_2day_nrchem_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_nrchem_2x4/atmos.astart
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga_amip_exp_2day_nrchem_4x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_nrchem_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day nrchem
        [[[job]]]
            execution time limit = PT50M

   # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_nrchem_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM_DIR
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_2day_nrchem_2x4
            KGO=0
            
    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_nrchem_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM_DIR
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day_nrchem_4x9
            KGO=0

{%- if INTEGRATION_TESTING == true %}
    # Atmosphere Model Run for proc comparison

    [[atmos_meto_xc40_n48_ga_amip_exp_2day_nrchem_6x6]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_nrchem_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day nrchem
        [[[job]]]
            execution time limit = PT50M

   # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_nrchem_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY_NRCHEM, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_2day_nrchem_6x6
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day_nrchem_4x9
            KGO=

{%- endif %}

{%- endif %}

{% if "meto_xc40_n48_ga_amip_exp_naming" in name_graphs_out %}
# N48 special configuration for testing file naming schemes

    [[METO_XC40_N48_GA_AMIP_EXP_NAMING]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_NAMING_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_naming/{{XC40_N48_GA_AMIP_EXP_NAMING_KGO}}

    [[recon_meto_xc40_n48_ga_amip_exp_naming_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_naming_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS = naming-base
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga_amip_exp_naming_4x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_naming_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS = n48 naming-base
        [[[job]]]
            execution time limit = PT49M

    [[rose_ana_meto_xc40_n48_ga_amip_exp_naming_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP_NAMING
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_NAMING_DIR
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_naming_4x9
            KGO=0
        [[[directives]]]
            -l mem = 2GB

    [[rose_ana_meto_xc40_n48_ga_amip_exp_naming_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_NAMING_DIR
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_naming_2x4
            KGO=0

    # Namespace families for the install and archiving
    [[XC40_GA_AMIP_EXP_NAMING_CRUN_INSTALL, XC40_GA_AMIP_EXP_NAMING_CRUN_ARCHIVE]]

    # Atmosphere model NRUN
    [[atmos_meto_xc40_n48_ga_amip_exp_naming_crun_4x9_0]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_naming_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS = n48 naming-base naming-nrun
        [[[job]]]
            execution time limit = PT49M

    {% for crun_no in range(1,4) %}
        
        # Atmosphere model CRUNs
        [[atmos_meto_xc40_n48_ga_amip_exp_naming_crun_4x9_{{crun_no}}]]
            inherit = METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
            [[[environment]]]
                ASTART=../recon_meto_xc40_n48_ga_amip_exp_naming_2x4/atmos.astart
                ROSE_APP_OPT_CONF_KEYS = n48 naming-base naming-crun{{crun_no}}
                CONTINUE=true
            [[[job]]]
                execution time limit = PT49M

        # Task which moves results forwards
        [[meto_xc40_ga_amip_exp_naming_crun_install_{{crun_no}}]]
            inherit = XC40_GA_AMIP_EXP_NAMING_CRUN_INSTALL
            script = """
            $CYLC_SUITE_RUN_DIR/app/um_ga_amip_exp/bin/crun_install.sh
            """
            [[[environment]]]
                ATMOS_PREV=atmos_meto_xc40_n48_ga_amip_exp_naming_crun_4x9_{{crun_no - 1}}
                ATMOS_NEW=atmos_meto_xc40_n48_ga_amip_exp_naming_crun_4x9_{{crun_no}}
            [[[remote]]]
                host = $(rose host-select {{ HOST_XC40 }})

    {% endfor %}

    {% for crun_no in range(0,4) %}

        # Task which moves files to "archive" folder
        [[meto_xc40_ga_amip_exp_naming_crun_archive_{{crun_no}}]]
            inherit = XC40_GA_AMIP_EXP_NAMING_CRUN_ARCHIVE
            script = """
            $CYLC_SUITE_RUN_DIR/app/um_ga_amip_exp/bin/crun_archive.sh
            """
            [[[environment]]]
                ARCHIVE_DIR=$CYLC_SUITE_SHARE_DIR/N48_GA_AMIP_EXP_NAMING_CRUN_XC40
                ATMOS_DIR=atmos_meto_xc40_n48_ga_amip_exp_naming_crun_4x9_{{crun_no}}
                CRUN_NO={{crun_no}}
            [[[remote]]]
                host = $(rose host-select {{ HOST_XC40 }})

    {% endfor %}

    # Comparison task for the final point of the CRUNs
    [[rose_ana_meto_xc40_n48_ga_amip_exp_naming_lrun_crun_atmos]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_NAMING, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP_NAMING
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_naming_4x9
            DIR1=$CYLC_SUITE_SHARE_DIR/N48_GA_AMIP_EXP_NAMING_CRUN_XC40
            KGO=
        [[[directives]]]
            -l mem = 2GB

{% endif %}

{% if "meto_xc40_n48_ga_amip_exp_2day_comp_check" in name_graphs_out -%}
# N48 GA_AMIP_EXP "climate" configuration - 2-day variant with rigorous compiler optimisation
    [[METO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_2day_comp_check/{{XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga_amip_exp_2day_comp_check_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_comp_check_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga_amip_exp_2day_comp_check_4x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_2day_comp_check_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 2day
        [[[job]]]
            execution time limit = PT99M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_comp_check_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=2day
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK_DIR
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_2day_comp_check_4x9
            KGO=0

    [[rose_ana_meto_xc40_n48_ga_amip_exp_2day_comp_check_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_2DAY_COMP_CHECK_DIR
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_2day_comp_check_2x4
            KGO=0

{%- endif %}

{% if "meto_xc40_n48_ga_amip_exp_10day" in name_graphs_out -%}
# N48 GA_AMIP_EXP "climate" configuration - 10-day variant using 'HIGH'
    [[METO_XC40_N48_GA_AMIP_EXP_10DAY]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_10DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_10day/{{XC40_N48_GA_AMIP_EXP_10DAY_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga_amip_exp_10day_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_10day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga_amip_exp_10day_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_10day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga_amip_exp_10day_12x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_216, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_10day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[job]]]
            execution time limit = PT66M

    [[atmos_meto_xc40_n48_ga_amip_exp_10day_16x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_10day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 10day
        [[[job]]]
            execution time limit = PT66M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga_amip_exp_10day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=10day
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_10day_16x9
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_10day_12x9
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_10day_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=10day
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_10DAY_DIR
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_10day_12x9
            KGO=0

    [[rose_ana_meto_xc40_n48_ga_amip_exp_10day_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ga_amip_exp_10day_4x2
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_10day_2x4
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_10day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_10DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_10DAY_DIR
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_10day_2x4
            KGO=0

{%- endif %}


{% if "meto_xc40_n48_ga_amip_exp_30day" in name_graphs_out -%}
# N48 GA_AMIP_EXP "climate" configuration - 30-day variant
    [[METO_XC40_N48_GA_AMIP_EXP_30DAY]]
        inherit = METO_XC40_N48_GA_COMMON
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_GA_AMIP_EXP_30DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ga_amip_exp_30day/{{XC40_N48_GA_AMIP_EXP_30DAY_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n48_ga_amip_exp_30day_2x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_30day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[recon_meto_xc40_n48_ga_amip_exp_30day_4x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x2, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_30day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT5M

    [[atmos_meto_xc40_n48_ga_amip_exp_30day_12x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_216, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_30day_2x4/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[job]]]
            execution time limit = PT99M

    [[atmos_meto_xc40_n48_ga_amip_exp_30day_16x9]]
        inherit = METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_GA_AMIP_EXP
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ga_amip_exp_30day_4x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=n48 30day
        [[[job]]]
            execution time limit = PT99M

    # Comparison tasks
    [[rose_ana_meto_xc40_n48_ga_amip_exp_30day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=30day
            DIR0=../atmos_meto_xc40_n48_ga_amip_exp_30day_16x9
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_30day_12x9
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_30day_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40, ROSE_ANA_N48_GA_AMIP_EXP
        [[[directives]]]
            -l mem = 2GB
        [[[environment]]]
            ROSE_APP_OPT_CONF_KEYS=30day
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_30DAY_DIR
            DIR1=../atmos_meto_xc40_n48_ga_amip_exp_30day_12x9
            KGO=0

    [[rose_ana_meto_xc40_n48_ga_amip_exp_30day_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ga_amip_exp_30day_4x2
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_30day_2x4
            KGO=

    [[rose_ana_meto_xc40_n48_ga_amip_exp_30day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_GA_AMIP_EXP_30DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_GA_AMIP_EXP_30DAY_DIR
            DIR1=../recon_meto_xc40_n48_ga_amip_exp_30day_2x4
            KGO=0

{%- endif %}


{% if "meto_xc40_n96_triffid_eg" in name_graphs_out -%}

# N96 Endgame Triffid XC40
    [[METO_XC40_N96_TRIFFID_EG]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_TRIFFID_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_triffid_eg/{{XC40_N96_TRIFFID_EG_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n96_triffid_eg]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N96_TRIFFID_EG, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_TRIFFID_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_eg/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT6M

    # Atmos
    [[atmos_meto_xc40_n96_triffid_eg_12x9]]
        inherit = METO_XC40_N96_TRIFFID_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_216, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x9, IOS_0, UM_TRIFFID_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_eg/atmos.astart
        [[[job]]]
            execution time limit = PT30M

    [[atmos_meto_xc40_n96_triffid_eg_12x12]]
        inherit = METO_XC40_N96_TRIFFID_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x12, IOS_0, UM_TRIFFID_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_eg/atmos.astart
        [[[job]]]
            execution time limit = PT30M

    # Comparison tasks
    [[rose_ana_meto_xc40_n96_triffid_eg_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N96_TRIFFID_EG_DIR
            DIR1=../recon_meto_xc40_n96_triffid_eg
            KGO=0

    [[rose_ana_meto_xc40_n96_triffid_eg_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_EG, METO_XC40, ROSE_ANA_TRIFFID_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N96_TRIFFID_EG_DIR
            DIR1=../atmos_meto_xc40_n96_triffid_eg_12x12
            KGO=0

    [[rose_ana_meto_xc40_n96_triffid_eg_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_EG, METO_XC40, ROSE_ANA_TRIFFID_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_triffid_eg_12x9
            DIR1=../atmos_meto_xc40_n96_triffid_eg_12x12
            KGO=

    [[rose_ana_meto_xc40_n96_triffid_eg_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_N96_TRIFFID_EG, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_triffid_eg_12x12
            DIR1= $KGO_XC40_N96_TRIFFID_EG_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1


{%- endif %}

{% if "meto_xc40_n96_triffid_eg_2day" in name_graphs_out -%}

# N96 Endgame Triffid_2day XC40
    [[METO_XC40_N96_TRIFFID_EG_2DAY]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_TRIFFID_EG_2DAY_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_triffid_eg_2day/{{XC40_N96_TRIFFID_EG_2DAY_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n96_triffid_eg_2day]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N96_TRIFFID_EG_2DAY, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_TRIFFID_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_eg_2day/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT5M

    # Atmos
    [[atmos_meto_xc40_n96_triffid_eg_2day_12x9]]
        inherit = METO_XC40_N96_TRIFFID_EG_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_216, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x9, IOS_0, UM_TRIFFID_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_eg_2day/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=2dayrun
        [[[job]]]
            execution time limit = PT11M

    # Comparison tasks
    [[rose_ana_meto_xc40_n96_triffid_eg_2day_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_EG_2DAY, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N96_TRIFFID_EG_2DAY_DIR
            DIR1=../recon_meto_xc40_n96_triffid_eg_2day
            KGO=0

    [[rose_ana_meto_xc40_n96_triffid_eg_2day_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_EG_2DAY, METO_XC40, ROSE_ANA_TRIFFID_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N96_TRIFFID_EG_2DAY_DIR
            DIR1=../atmos_meto_xc40_n96_triffid_eg_2day_12x9
            KGO=0


{%- if INTEGRATION_TESTING == true %}

    [[atmos_meto_xc40_n96_triffid_eg_2day_16x9]]
        inherit = METO_XC40_N96_TRIFFID_EG_2DAY, METO_XC40_IOS_OFF, METO_XC40_CORES_288, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_16x9, IOS_0, UM_TRIFFID_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_eg_2day/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=2dayrun
        [[[job]]]
            execution time limit = PT11M

    [[rose_ana_meto_xc40_n96_triffid_eg_2day_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_EG_2DAY, METO_XC40, ROSE_ANA_TRIFFID_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_triffid_eg_2day_12x9
            DIR1=../atmos_meto_xc40_n96_triffid_eg_2day_16x9
            KGO=

{%- endif %}

{%- endif %}


{% if "meto_xc40_n96_triffid_esm_eg" in name_graphs_out -%}

# N96 Endgame Triffid XC40
    [[METO_XC40_N96_TRIFFID_ESM_EG]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_TRIFFID_ESM_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_triffid_esm_eg/{{XC40_N96_TRIFFID_ESM_EG_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n96_triffid_esm_eg]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_TRIFFID_ESM_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_esm_eg/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT6M

    # Atmos
    [[atmos_meto_xc40_n96_triffid_esm_eg_18x12]]
        inherit = METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_18x12, IOS_0, UM_TRIFFID_ESM_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_esm_eg/atmos.astart
        [[[job]]]
            execution time limit = PT22M

    [[atmos_meto_xc40_n96_triffid_esm_eg_12x18]]
        inherit = METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_432, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_12x18, IOS_0, UM_TRIFFID_ESM_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_triffid_esm_eg/atmos.astart
        [[[job]]]
            execution time limit = PT22M

    # Comparison tasks
    [[rose_ana_meto_xc40_n96_triffid_esm_eg_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N96_TRIFFID_ESM_EG_DIR
            DIR1=../recon_meto_xc40_n96_triffid_esm_eg
            KGO=0

    [[rose_ana_meto_xc40_n96_triffid_esm_eg_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40, ROSE_ANA_TRIFFID_ESM_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N96_TRIFFID_ESM_EG_DIR
            DIR1=../atmos_meto_xc40_n96_triffid_esm_eg_12x18
            KGO=0

    [[rose_ana_meto_xc40_n96_triffid_esm_eg_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40, ROSE_ANA_TRIFFID_ESM_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_triffid_esm_eg_12x18
            DIR1=../atmos_meto_xc40_n96_triffid_esm_eg_18x12
            KGO=

    [[rose_ana_meto_xc40_n96_triffid_esm_eg_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_N96_TRIFFID_ESM_EG, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_triffid_esm_eg_12x18
            DIR1= $KGO_XC40_N96_TRIFFID_ESM_EG_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1




{%- endif %}

{% if "meto_xc40_n512_eg" in name_graphs_out or "meto_xc40_global_to_lam_eg" in name_graphs_out -%}
# N512 Endgame XC40
    [[METO_XC40_N512_EG]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_FAST_OMP_SINGLE_PRECIS }}"
        [[[environment]]]
            KGO_XC40_N512_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n512_eg/{{XC40_N512_EG_KGO}}

    # Reconfiguration
    [[recon_meto_xc40_n512_eg]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_FAST_OMP_SINGLE_PRECIS }}"
        inherit = METO_XC40_N512_EG, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x4, UM_N512_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n512_eg/atmos.astart
        [[[directives]]]
            -l mem = 18GB
        [[[job]]]
            execution time limit = PT19M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n512_eg_10x23]]
        inherit = METO_XC40_N512_EG, METO_XC40_IOS_ON, METO_XC40_CORES_468, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_10x23, IOS_4, UM_N512_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n512_eg/atmos.astart
        [[[job]]]
            execution time limit = PT19M

    # Comparison tasks
    [[rose_ana_meto_xc40_n512_eg_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N512_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N512_EG_DIR
            DIR1=../recon_meto_xc40_n512_eg
            KGO=0

    [[rose_ana_meto_xc40_n512_eg_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N512_EG, METO_XC40, ROSE_ANA_N512_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N512_EG_DIR
            DIR1=../atmos_meto_xc40_n512_eg_10x23
            KGO=0

    [[rose_ana_meto_xc40_n512_eg_wallclock_kgo]]
        inherit = METO_XC40_ROSE_ANA_WALLCLOCK_COMPARISON, METO_XC40_N512_EG, METO_XC40
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n512_eg_10x23
            DIR1=$KGO_XC40_N512_EG_DIR
            ROSE_APP_OPT_CONF_KEYS=fifty_percent
            KGO=1

{%- endif %}

{% if "meto_xc40_n96_amip_eg" in name_graphs_out -%}
# N96 Endgame AMIP

    [[METO_XC40_N96_AMIP_EG]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_AMIP_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_amip_eg/{{XC40_N96_AMIP_EG_KGO}}

    # Reconfiguration 1x4
    [[recon_meto_xc40_n96_amip_eg_1x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N96_AMIP_EG, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_N96_AMIP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_1x4/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT5M

    # Reconfiguration 4x1
    [[recon_meto_xc40_n96_amip_eg_4x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N96_AMIP_EG, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_4x1, UM_N96_AMIP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_4x1/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT5M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_amip_eg_4x9]]
        inherit = METO_XC40_N96_AMIP_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_N96_AMIP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_1x4/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_amip_eg_6x6]]
        inherit = METO_XC40_N96_AMIP_EG, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_N96_AMIP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_4x1/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    [[rose_ana_meto_xc40_n96_amip_eg_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG, METO_XC40, ROSE_ANA_N96_AMIP_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N96_AMIP_EG_DIR
            DIR1=../atmos_meto_xc40_n96_amip_eg_4x9
            KGO=0

    [[rose_ana_meto_xc40_n96_amip_eg_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N96_AMIP_EG_DIR
            DIR1=../recon_meto_xc40_n96_amip_eg_1x4
            KGO=0

    [[rose_ana_meto_xc40_n96_amip_eg_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG, METO_XC40, ROSE_ANA_N96_AMIP_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_amip_eg_6x6
            DIR1=../atmos_meto_xc40_n96_amip_eg_4x9
            KGO=

    [[rose_ana_meto_xc40_n96_amip_eg_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n96_amip_eg_4x1
            DIR1=../recon_meto_xc40_n96_amip_eg_1x4
            KGO=

{%- endif %}

{% if "meto_xc40_n96_amip_eg_fvtrack" in name_graphs_out -%}
# N96 Endgame AMIP

    [[METO_XC40_N96_AMIP_EG_FVTRACK]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_AMIP_EG_FVTRACK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_amip_eg_fvtrack/{{XC40_N96_AMIP_EG_FVTRACK_KGO}}

    # Reconfiguration 1x4
    [[recon_meto_xc40_n96_amip_eg_fvtrack_1x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_HIGH_OMP }}"
        inherit = METO_XC40_N96_AMIP_EG_FVTRACK, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_N96_AMIP_EG_FVTRACK
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_fvtrack_1x4/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT5M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_amip_eg_fvtrack_4x9]]
       inherit = METO_XC40_N96_AMIP_EG_FVTRACK, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_N96_AMIP_EG_FVTRACK
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_fvtrack_1x4/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_amip_eg_fvtrack_6x6]]
       inherit = METO_XC40_N96_AMIP_EG_FVTRACK, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_N96_AMIP_EG_FVTRACK
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_fvtrack_1x4/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    [[rose_ana_meto_xc40_n96_amip_eg_fvtrack_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG_FVTRACK, METO_XC40, ROSE_ANA_N96_AMIP_EG_FVTRACK
        [[[environment]]]
            DIR0=$KGO_XC40_N96_AMIP_EG_FVTRACK_DIR
            DIR1=../atmos_meto_xc40_n96_amip_eg_fvtrack_4x9
            KGO=0

    [[rose_ana_meto_xc40_n96_amip_eg_fvtrack_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG_FVTRACK, METO_XC40, ROSE_ANA_N96_AMIP_EG_FVTRACK
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_amip_eg_fvtrack_6x6
            DIR1=../atmos_meto_xc40_n96_amip_eg_fvtrack_4x9
            KGO=

{%- endif %}

{% if "meto_xc40_n96_eg_dyntracers" in name_graphs_out -%}
# N96 Endgame with PV-tracer scheme

    [[METO_XC40_N96_EG_DYNTRACERS]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N96_EG_DYNTRACERS_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_eg_dyntracers/{{XC40_N96_EG_DYNTRACERS_KGO}}

    # Reconfiguration 1x4
    [[recon_meto_xc40_n96_eg_dyntracers_1x4]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N96_EG_DYNTRACERS, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_N96_EG_DYNTRACERS
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_eg_dyntracers_1x4/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT3M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_eg_dyntracers_4x9]]
       inherit = METO_XC40_N96_EG_DYNTRACERS, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_N96_EG_DYNTRACERS
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_eg_dyntracers_1x4/atmos.astart
        [[[job]]]
            execution time limit = PT7M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_eg_dyntracers_6x6]]
       inherit = METO_XC40_N96_EG_DYNTRACERS, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_6x6, IOS_0, UM_N96_EG_DYNTRACERS
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_eg_dyntracers_1x4/atmos.astart
        [[[job]]]
            execution time limit = PT10M

    [[rose_ana_meto_xc40_n96_eg_dyntracers_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_EG_DYNTRACERS, METO_XC40, ROSE_ANA_N96_EG_DYNTRACERS
        [[[environment]]]
            DIR0=$KGO_XC40_N96_EG_DYNTRACERS_DIR
            DIR1=../atmos_meto_xc40_n96_eg_dyntracers_4x9
            KGO=0

    [[rose_ana_meto_xc40_n96_eg_dyntracers_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_EG_DYNTRACERS, METO_XC40, ROSE_ANA_N96_EG_DYNTRACERS
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n96_eg_dyntracers_6x6
            DIR1=../atmos_meto_xc40_n96_eg_dyntracers_4x9
            KGO=

{%- endif %}

{%- if "meto_xc40_n96_amip_eg_drhook" in name_graphs_out %}

    [[METO_XC40_N96_AMIP_EG_DRHOOK]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP_DRHOOK }}"
        [[[environment]]]
            KGO_XC40_N96_AMIP_EG_DRHOOK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n96_amip_eg_drhook/{{XC40_N96_AMIP_EG_DRHOOK_KGO}}

    # Reconfiguration 1x4
    [[recon_meto_xc40_n96_amip_eg_drhook]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP_DRHOOK }}"
        inherit = METO_XC40_N96_AMIP_EG_DRHOOK, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x4, UM_N96_AMIP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_drhook/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=drhook
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT5M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n96_amip_eg_drhook_4x9]]
        inherit = METO_XC40_N96_AMIP_EG_DRHOOK, METO_XC40_IOS_OFF, METO_XC40_CORES_72, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x9, IOS_0, UM_N96_AMIP_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n96_amip_eg_drhook/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=drhook
        [[[job]]]
            execution time limit = PT10M

    [[rose_ana_meto_xc40_n96_amip_eg_drhook_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG_DRHOOK, METO_XC40, ROSE_ANA_DRHOOK
        [[[environment]]]
            DIR0=$KGO_XC40_N96_AMIP_EG_DRHOOK_DIR
            DIR1=../recon_meto_xc40_n96_amip_eg_drhook
            KGO=0

    # Comparison tasks; VARIANT required for atmos_proc comparison
    [[rose_ana_meto_xc40_n96_amip_eg_drhook_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N96_AMIP_EG_DRHOOK, METO_XC40, ROSE_ANA_DRHOOK
        [[[environment]]]
            DIR0=$KGO_XC40_N96_AMIP_EG_DRHOOK_DIR
            DIR1=../atmos_meto_xc40_n96_amip_eg_drhook_4x9
            KGO=0

{%- endif %}

{% if "meto_xc40_n48_eg_omp_ios" in name_graphs_out 
   or "meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread" in name_graphs_out 
   or "meto_xc40_n48_eg_omp_noios" in name_graphs_out -%}
# Same family and make task used by both OpenMP IOS and OpenMP no-IOS jobs

    [[METO_XC40_N48_EG_OMP]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg/{{XC40_N48_EG_KGO}}
            KGO_XC40_N48_EG_SHORTSTEP_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_shortstep/{{XC40_N48_EG_SHORTSTEP_KGO}}

{%- endif %}

{% if "meto_xc40_n48_eg_omp_ios" in name_graphs_out -%}
# N48 EG job

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
        [[[directives]]]
            -l mem = 8GB
        [[[job]]]
            execution time limit = PT11M

    # Reconfiguration 2x1
    [[recon_meto_xc40_n48_eg_omp_ios_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_2x1/atmos.astart
        [[[directives]]]
            -l mem = 8GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_2x1]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_2x1
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_ios_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_ios_2x1
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_1x2
            KGO=

    # Atmosphere EG Model Run 1x2 nrun
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_nrun]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=nrun
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere EG Model Run 1x2 crun
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_crun]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=crun
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT16M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_lrun_crun_atmos]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG_CRUN
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_1x2
            KGO=

    #Atmosphere EG model Run 1x2 NRUN + NRUN test
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_lrun]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_12, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_4, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ancilUpdate analysisOff alphaRelaxOff lrun 
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT33M

    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_nrun1]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_12, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_4, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ancilUpdate analysisOff alphaRelaxOff nrun1 
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_NrunNrun
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_NrunNrun
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT33M

    # Atmosphere Model Run Nrun2
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_nrun2]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_12, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_4, UM_N48_EG
        [[[environment]]]
# change astart to dump in shared
            ASTART=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_NrunNrun/atmosa_da006
            ROSE_APP_OPT_CONF_KEYS=ancilUpdate analysisOff alphaRelaxOff nrun2
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_NrunNrun_part2
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_NrunNrun_part2
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT33M

    # Comparison task n48_eg nrun_nrun
    [[rose_ana_meto_xc40_n48_eg_nrun_nrun_atmos]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG_NRUN_NRUN
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_1x2_lrun
            DIR1=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_NrunNrun_part2
            KGO=
            
    [[rose_ana_meto_xc40_n48_eg_norms]]
        inherit= METO_XC40_ROSE_ANA_COMPARISON, METO_XC40, ROSE_ANA_EG_NORMS
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_1x2_lrun
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_1x2_nrun2
            KGO=
        [[[directives]]]
            -l mem = 256MB
        [[[job]]]
            execution time limit = PT3M
        
    # Atmosphere EG Model Run 1x2 nrun - shortstep version
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_nrun_shortstep]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=nrun
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS_SHORTSTEP
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS_SHORTSTEP
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere EG Model Run 1x2 crun - shortstep version
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_crun_shortstep]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=crun shortstep
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS_SHORTSTEP
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS_SHORTSTEP
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT16M

    # Shortstep version has no equivalent single run, so uses its own KGO
    [[rose_ana_meto_xc40_n48_eg_omp_ios_crun_shortstep_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG_CRUN
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_SHORTSTEP_DIR
            DIR1=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_OMP_IOS_SHORTSTEP
            KGO=0

    # Atmosphere Model Run dynamics only
    [[atmos_meto_xc40_n48_eg_omp_ios_1x2_dyn]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=dyn
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT10M

    # Atmosphere Model Run dynamics only
    [[atmos_meto_xc40_n48_eg_omp_ios_2x1_dyn]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=dyn
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT10M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_atmos_proc_dyn]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_2x1_dyn
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_1x2_dyn
            KGO=


{%- endif %}

{% if "meto_xc40_n48_eg_omp_ios_moruses" in name_graphs_out -%}
    [[METO_XC40_N48_EG_MORUSES_OMP]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_MORUSES_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_moruses/{{XC40_N48_EG_MORUSES_KGO}}
            KGO_XC40_N48_EG_MORUSES_SHORTSTEP_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_moruses_shortstep/{{XC40_N48_EG_MORUSES_SHORTSTEP_KGO}}

# N48 EG job with MORUSES

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_moruses_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=moruses
        [[[directives]]]
            -l mem = 8GB
        [[[job]]]
            execution time limit = PT11M

    # Reconfiguration 2x1
    [[recon_meto_xc40_n48_eg_omp_ios_moruses_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=moruses
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=moruses
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_2x1]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads moruses
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_moruses_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_MORUSES_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_moruses_recon_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_MORUSES_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_moruses_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_moruses_2x1
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_ios_moruses_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_ios_moruses_2x1
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2
            KGO=

    # Atmosphere EG Model Run 1x2 nrun
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_nrun]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=nrun moruses
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere EG Model Run 1x2 crun
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_crun]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=crun moruses
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT16M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_moruses_lrun_crun_atmos]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_N48_EG_CRUN
        [[[environment]]]
            DIR0=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2
            KGO=


    #Atmosphere EG model Run 1x2 NRUN + NRUN test
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_lrun]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_12, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_4, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ancilUpdate analysisOff alphaRelaxOff lrun moruses
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT33M

    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_nrun1]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_12, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_4, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ancilUpdate analysisOff alphaRelaxOff nrun1 moruses
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_moruses_NrunNrun
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_moruses_NrunNrun
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT33M

    # Atmosphere Model Run Nrun2
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_nrun2]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_12, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_4, UM_N48_EG
        [[[environment]]]
# change astart to dump in shared
            ASTART=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_moruses_NrunNrun/atmosa_da006
            ROSE_APP_OPT_CONF_KEYS=ancilUpdate analysisOff alphaRelaxOff nrun2 moruses
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_moruses_NrunNrun_part2
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_moruses_NrunNrun_part2
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT33M

    # Comparison task n48_eg nrun_nrun
        [[rose_ana_meto_xc40_n48_eg_moruses_nrun_nrun_atmos]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_N48_EG_NRUN_NRUN
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_lrun
            DIR1=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_n48_eg_moruses_NrunNrun_part2
            KGO=
            
    [[rose_ana_meto_xc40_n48_eg_moruses_norms]]
        inherit= METO_XC40_ROSE_ANA_COMPARISON, METO_XC40, ROSE_ANA_EG_NORMS
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_lrun
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_nrun2
            KGO=
        [[[directives]]]
            -l mem = 256MB
        [[[job]]]
            execution time limit = PT3M
        
    # Atmosphere EG Model Run 1x2 nrun - shortstep version
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_nrun_shortstep]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=nrun moruses
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS_SHORTSTEP
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS_SHORTSTEP
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT16M

    # Atmosphere EG Model Run 1x2 crun - shortstep version
    [[atmos_meto_xc40_n48_eg_omp_ios_moruses_1x2_crun_shortstep]]
        inherit = METO_XC40_N48_EG_MORUSES_OMP, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_moruses_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=crun shortstep moruses
            CONTINUE=true
            DATAW=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS_SHORTSTEP
            DATAM=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS_SHORTSTEP
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT16M

    # Shortstep version has no equivalent single run, so uses its own KGO
    [[rose_ana_meto_xc40_n48_eg_omp_ios_moruses_crun_shortstep_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_MORUSES_OMP, METO_XC40, ROSE_ANA_N48_EG_CRUN
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_MORUSES_SHORTSTEP_DIR
            DIR1=$CYLC_SUITE_SHARE_DIR/data/METO_XC40_N48_EG_MORUSES_OMP_IOS_SHORTSTEP
            KGO=0

{%- endif %}

{% if "meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread" in name_graphs_out -%}
# N48 EG job

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT7M

    # Reconfiguration 2x1
    [[recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_2x1/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT7M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_6, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_2x1]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_6, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_2x1/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_2x1
            DIR1=../atmos_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_2x1
            DIR1=../recon_meto_xc40_n48_eg_omp_atmos_1_thread_ios_2_thread_1x2
            KGO=

{%- endif %}

{% if "meto_xc40_n48_eg_omp_ios_ifort" in name_graphs_out-%}
# N48 EG job using Intel compiler

    [[METO_XC40_N48_EG_OMP_IFORT]]
        script = "{{TASK_RUN}} {{ UM_XC40_IFORT_HIGH_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_IFORT_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_ifort/{{XC40_N48_EG_IFORT_KGO}}

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_ifort_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_IFORT_HIGH_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_IFORT, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_ifort_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Reconfiguration 2x1
    [[recon_meto_xc40_n48_eg_omp_ios_ifort_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_IFORT_HIGH_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_IFORT, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_ifort_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_ifort_1x2]]
        inherit = METO_XC40_N48_EG_OMP_IFORT, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_ifort_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_ifort_2x1]]
        inherit = METO_XC40_N48_EG_OMP_IFORT, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_ifort_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_ifort_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_IFORT, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_IFORT_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_ifort_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_ifort_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_IFORT, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_IFORT_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_ifort_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_ifort_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_IFORT, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_ifort_2x1
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_ifort_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_ios_ifort_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_IFORT, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_ios_ifort_2x1
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_ifort_1x2
            KGO=
{%- endif %}


{% if "meto_xc40_n48_eg_omp_ios_gnu" in name_graphs_out-%}
# N48 EG job using Intel compiler

    [[METO_XC40_N48_EG_OMP_GNU]]
        script = "{{TASK_RUN}} {{ UM_XC40_GNU_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_GNU_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_gnu/{{XC40_N48_EG_GNU_KGO}}

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_gnu_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_GNU, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Reconfiguration 2x1
    [[recon_meto_xc40_n48_eg_omp_ios_gnu_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_GNU, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_gnu_1x2]]
        inherit = METO_XC40_N48_EG_OMP_GNU, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_1x2/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_ios_gnu_2x1]]
        inherit = METO_XC40_N48_EG_OMP_GNU, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_2x1/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_GNU_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_gnu_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_GNU_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_gnu_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_gnu_2x1
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_gnu_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_ios_gnu_2x1
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_gnu_1x2
            KGO=

{%- endif %}

{% if "meto_xc40_n48_eg_omp_ios_gnu_comp_check" in name_graphs_out %}

    [[METO_XC40_N48_EG_OMP_GNU_COMP_CHECK]]
        script = "{{TASK_RUN}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_GNU_COMP_CHECK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_gnu_comp_check/{{XC40_N48_EG_GNU_COMP_CHECK_KGO}}

    [[recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2]]
        inherit = METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT49M

    [[atmos_meto_xc40_n48_eg_omp_ios_gnu_comp_check_2x1]]
        inherit = METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_2x1/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT49M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_comp_check_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_GNU_COMP_CHECK_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_comp_check_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_GNU_COMP_CHECK_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_comp_check_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2
            DIR1=../recon_meto_xc40_n48_eg_omp_ios_gnu_comp_check_2x1
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_ios_gnu_comp_check_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_gnu_comp_check_1x2
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_gnu_comp_check_2x1
            KGO=

{%- endif %}

{% if "meto_xc40_n48_ukca_eg_omp_noios_gnu" in name_graphs_out %}

    [[METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU]]
        script = "{{TASK_RUN}} {{ UM_XC40_GNU_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ukca_eg_gnu/{{XC40_N48_UKCA_EG_GNU_KGO}}

    [[recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_SAFE_OMP }}"
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_4x4]]
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40_IOS_OFF, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x4, IOS_0, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_1x2/atmos.astart
        [[[directives]]]
            -l mem = 10GB
        [[[job]]]
            execution time limit = PT8M

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_DIR
            DIR1=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40, ROSE_ANA_N48_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_DIR
            DIR1=../atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_4x4
            KGO=0

{%- if INTEGRATION_TESTING == true %}

    [[recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_SAFE_OMP }}"
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_8x2]]
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40_IOS_OFF, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x2, IOS_0, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_2x1/atmos.astart
        [[[directives]]]
            -l mem = 10GB
        [[[job]]]
            execution time limit = PT8M

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_recon_proc]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_2x1
            DIR1=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_atmos_proc]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU, METO_XC40, ROSE_ANA_N48_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_8x2
            DIR1=../atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_4x4
            KGO=

{%- endif %}

{%- endif %}

{% if "meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check" in name_graphs_out %}

    [[METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK]]
        script = "{{TASK_RUN}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ukca_eg_gnu_comp_check/{{XC40_N48_UKCA_EG_GNU_COMP_CHECK_KGO}}

    [[recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_4x4]]
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40_IOS_OFF, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_4x4, IOS_0, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_1x2/atmos.astart
        [[[directives]]]
            -l mem = 16GB
        [[[job]]]
            execution time limit = PT24M

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK_DIR
            DIR1=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_N48_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK_DIR
            DIR1=../atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_4x4
            KGO=0

{%- if INTEGRATION_TESTING == true %}

    [[METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK]]
        script = "{{TASK_RUN}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ukca_eg_gnu_comp_check/{{XC40_N48_UKCA_EG_GNU_COMP_CHECK_KGO}}

    [[recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_8x2]]
        inherit = METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40_IOS_OFF, METO_XC40_CORES_32, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_8x2, IOS_0, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_2x1/atmos.astart
        [[[directives]]]
            -l mem = 16GB
        [[[job]]]
            execution time limit = PT24M

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_recon_proc]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_2x1
            DIR1=../recon_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_atmos_proc]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_OMP_NOIOS_GNU_COMP_CHECK, METO_XC40, ROSE_ANA_N48_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_8x2
            DIR1=../atmos_meto_xc40_n48_ukca_eg_omp_noios_gnu_comp_check_4x4
            KGO=

{%- endif %}

{%- endif %}

{% if "meto_xc40_n48_ukca_eg_noomp_gnu" in name_graphs_out %}

    [[METO_XC40_N48_UKCA_EG_NOOMP_GNU]]
        script = "{{TASK_RUN}} {{ UM_XC40_GNU_SAFE_NOOMP }}"
        [[[environment]]]
            KGO_XC40_N48_UKCA_EG_NOOMP_GNU_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_ukca_eg_gnu_noomp/{{XC40_N48_UKCA_EG_GNU_NOOMP_KGO}}

    [[recon_meto_xc40_n48_ukca_eg_noomp_gnu_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_SAFE_NOOMP }}"
        inherit = METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_ukca_eg_noomp_gnu_4x4]]
        inherit = METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40_IOS_OFF, METO_XC40_CORES_16, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_4x4, IOS_0, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_1x2/atmos.astart
        [[[directives]]]
            -l mem = 10GB
        [[[job]]]
            execution time limit = PT8M

    [[rose_ana_meto_xc40_n48_ukca_eg_noomp_gnu_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_UKCA_EG_NOOMP_GNU_DIR
            DIR1=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_ukca_eg_noomp_gnu_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40, ROSE_ANA_N48_UKCA_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_UKCA_EG_NOOMP_GNU_DIR
            DIR1=../atmos_meto_xc40_n48_ukca_eg_noomp_gnu_4x4
            KGO=0

{%- if INTEGRATION_TESTING == true %}

    [[recon_meto_xc40_n48_ukca_eg_noomp_gnu_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_GNU_SAFE_NOOMP }}"
        inherit = METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_ukca_eg_noomp_gnu_8x2]]
        inherit = METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40_IOS_OFF, METO_XC40_CORES_16, METO_XC40_PARALLEL_THREADS_1, ATMOS_MPI, ATMOS_8x2, IOS_0, UM_N48_UKCA_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_2x1/atmos.astart
        [[[directives]]]
            -l mem = 10GB
        [[[job]]]
            execution time limit = PT8M

    [[rose_ana_meto_xc40_n48_ukca_eg_noomp_gnu_recon_proc]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_2x1
            DIR1=../recon_meto_xc40_n48_ukca_eg_noomp_gnu_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_ukca_eg_noomp_gnu_atmos_proc]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_UKCA_EG_NOOMP_GNU, METO_XC40, ROSE_ANA_N48_UKCA_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_ukca_eg_noomp_gnu_8x2
            DIR1=../atmos_meto_xc40_n48_ukca_eg_noomp_gnu_4x4
            KGO=

{%- endif %}

{%- endif %}

{% if "meto_xc40_n48_eg_omp_ios_comp_check" in name_graphs_out %}

    [[METO_XC40_N48_EG_OMP_COMP_CHECK]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"

    [[recon_meto_xc40_n48_eg_omp_ios_comp_check]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_RIGOROUS_OMP }}"
        inherit = METO_XC40_N48_EG_OMP_COMP_CHECK, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_comp_check/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    [[atmos_meto_xc40_n48_eg_omp_ios_comp_check]]
        inherit = METO_XC40_N48_EG_OMP_COMP_CHECK, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_comp_check/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT49M

{%- endif %}

{% if "meto_xc40_pws_diag_test" in name_graphs_out -%}
    [[METO_XC40_N48_EG_PWS]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_PWS_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_pws/{{XC40_N48_EG_PWS_KGO}}

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_PWS, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=pwsdiag
        [[[directives]]]
            -l mem = 8GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run 
    [[atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2]]
        inherit = METO_XC40_N48_EG_PWS, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=pwsdiag
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_2x1]]
        inherit = METO_XC40_N48_EG_PWS, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads pwsdiag
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    # Historically, some PWS diags have had prerequisite stash requests. These
    # should no longer be necessary (but may still be output). In this test we
    # remove the old dependencies.
    [[atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_no_dependencies_1x2]]
        inherit = METO_XC40_N48_EG_PWS, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=pwsdiag pwsdiag-no-dep
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_pws_diag_test_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_PWS, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_PWS_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2
            ROSE_APP_OPT_CONF_KEYS=pwsdiag
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_pws_diag_test_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_PWS, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_1x2
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_2x1
            ROSE_APP_OPT_CONF_KEYS=pwsdiag
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_ios_pws_diag_test_atmos_dependencies]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_PWS, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_PWS_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_pws_diag_test_no_dependencies_1x2
            ROSE_APP_OPT_CONF_KEYS=pwsdiag pwsdiag-no-dep
            KGO=0
{%- endif %}

{% if "meto_xc40_n48_eg_free_tracers" in name_graphs_out -%}
    [[METO_XC40_N48_EG_FT]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_FT_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_ft/{{XC40_N48_EG_FT_KGO}}

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_free_tracers_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_FT, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_free_tracers_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=freetr
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run 
    [[atmos_meto_xc40_n48_eg_omp_ios_free_tracers_1x2]]
        inherit = METO_XC40_N48_EG_FT, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_free_tracers_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=freetr
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[atmos_meto_xc40_n48_eg_omp_ios_free_tracers_2x1]]
        inherit = METO_XC40_N48_EG_FT, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_free_tracers_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads freetr
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_free_tracers_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_FT, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_FT_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_free_tracers_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_free_tracers_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_FT, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_free_tracers_1x2
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_free_tracers_2x1
            KGO=

{%- endif %}

{% if "meto_xc40_n48_eg_screen_dch" in name_graphs_out -%}
    [[METO_XC40_N48_EG_DCH]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_DCH_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_dch/{{XC40_N48_EG_DCH_KGO}}

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_ios_screen_dch_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_DCH, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_screen_dch_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=scrnhumdcp
        [[[directives]]]
            -l mem = 6GB
        [[[job]]]
            execution time limit = PT11M

    # Atmosphere Model Run 
    [[atmos_meto_xc40_n48_eg_omp_ios_screen_dch_1x2]]
        inherit = METO_XC40_N48_EG_DCH, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_screen_dch_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=scrnhumdcp
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[atmos_meto_xc40_n48_eg_omp_ios_screen_dch_2x1]]
        inherit = METO_XC40_N48_EG_DCH, METO_XC40_IOS_ON, METO_XC40_CORES_8, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_ios_screen_dch_1x2/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=ios-2-threads scrnhumdcp
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_ios_screen_dch_atmos_kgo]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_DCH, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DCH_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_screen_dch_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_ios_screen_dch_atmos_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_DCH, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_ios_screen_dch_1x2
            DIR1=../atmos_meto_xc40_n48_eg_omp_ios_screen_dch_2x1
            KGO=

{%- endif %}

{% if "meto_xc40_n48_eg_omp_noios" in name_graphs_out -%}
# N48 EG job

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_omp_noios_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_noios_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Reconfiguration 2x1
    [[recon_meto_xc40_n48_eg_omp_noios_2x1]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP }}"
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_2x1, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_noios_2x1/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_noios_1x2]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_OFF, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_0, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_noios_1x2/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_noios_2x1]]
        inherit = METO_XC40_N48_EG_OMP, METO_XC40_IOS_OFF, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_2x1, IOS_0, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_noios_2x1/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_noios_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_noios_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_noios_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_noios_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_noios_atmos_proc]] 
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=../atmos_meto_xc40_n48_eg_omp_noios_2x1
            DIR1=../atmos_meto_xc40_n48_eg_omp_noios_1x2
            KGO=

    [[rose_ana_meto_xc40_n48_eg_omp_noios_recon_proc]]
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_OMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=../recon_meto_xc40_n48_eg_omp_noios_2x1
            DIR1=../recon_meto_xc40_n48_eg_omp_noios_1x2
            KGO=

{%- endif %}



{% if "meto_xc40_n48_eg_noomp" in name_graphs_out -%}
# N48 EG job

    [[METO_XC40_N48_EG_NOOMP]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_NOOMP }}"
        [[[environment]]]
            KGO_XC40_N48_EG_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg/{{XC40_N48_EG_KGO}}

    # Reconfiguration 1x2
    [[recon_meto_xc40_n48_eg_noomp_1x2]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_NOOMP }}"
        inherit = METO_XC40_N48_EG_NOOMP, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_noomp_1x2/atmos.astart
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT9M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_noomp_1x2]]
        inherit = METO_XC40_N48_EG_NOOMP, METO_XC40_IOS_OFF, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_0, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_noomp_1x2/atmos.astart
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_noomp_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_NOOMP, METO_XC40, ROSE_ANA_N48_EG
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../atmos_meto_xc40_n48_eg_noomp_1x2
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_noomp_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_NOOMP, METO_XC40, ROSE_ANA_RECON
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DIR
            DIR1=../recon_meto_xc40_n48_eg_noomp_1x2
            KGO=0

{%- endif %}

{%- if "meto_xc40_n48_eg_omp_noios_drhook" in name_graphs_out %}

    [[METO_XC40_N48_EG_DRHOOK]]
        script = "{{TASK_RUN}} {{ UM_XC40_CCE_SAFE_OMP_DRHOOK }}"
        [[[environment]]]
            KGO_XC40_N48_EG_DRHOOK_DIR={{KGO_XC40_ROOT_DIR}}/xc40_n48_eg_drhook/{{XC40_N48_EG_DRHOOK_KGO}}

    [[recon_meto_xc40_n48_eg_omp_noios_drhook]]
        script = "{{TASK_RUN_RECON}} {{ UM_XC40_CCE_SAFE_OMP_DRHOOK }}"
        inherit = METO_XC40_N48_EG_DRHOOK, METO_XC40_CORES_2, METO_XC40_PARALLEL_THREADS_1, RECON_MPI, RECON_1x2, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_noios_drhook/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=drhook
        [[[directives]]]
            -l mem = 5GB
        [[[job]]]
            execution time limit = PT7M

    # Atmosphere Model Run
    [[atmos_meto_xc40_n48_eg_omp_noios_drhook_1x2]]
        inherit = METO_XC40_N48_EG_DRHOOK, METO_XC40_IOS_OFF, METO_XC40_CORES_4, METO_XC40_PARALLEL_THREADS_2, ATMOS_MPI, ATMOS_1x2, IOS_0, UM_N48_EG
        [[[environment]]]
            ASTART=../recon_meto_xc40_n48_eg_omp_noios_drhook/atmos.astart
            ROSE_APP_OPT_CONF_KEYS=drhook
        [[[directives]]]
            -l mem = 4GB
        [[[job]]]
            execution time limit = PT18M

    [[rose_ana_meto_xc40_n48_eg_omp_noios_drhook_recon_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_DRHOOK, METO_XC40, ROSE_ANA_DRHOOK
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DRHOOK_DIR
            DIR1=../recon_meto_xc40_n48_eg_omp_noios_drhook
            KGO=0

    [[rose_ana_meto_xc40_n48_eg_omp_noios_drhook_atmos_kgo]]  
        inherit = METO_XC40_ROSE_ANA_COMPARISON, METO_XC40_N48_EG_DRHOOK, METO_XC40, ROSE_ANA_DRHOOK
        [[[environment]]]
            DIR0=$KGO_XC40_N48_EG_DRHOOK_DIR
            DIR1=../atmos_meto_xc40_n48_eg_omp_noios_drhook_1x2
            KGO=0

{%- endif %}

